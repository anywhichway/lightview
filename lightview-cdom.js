var LightviewCDOM=function(e){"use strict";const t=new Map,r=new Map,n=(e,n,i={})=>{t.set(e,n),i&&r.set(e,i)},i=()=>globalThis.Lightview||null,s=()=>{var e;return(null==(e=i())?void 0:e.registry)||null};class o{constructor(e,t){this.parent=e,this.key=t,this.isBindingTarget=!0}get value(){return this.parent[this.key]}set value(e){this.parent[this.key]=e}get __parent__(){return this.parent}}const a=e=>e&&"function"==typeof e&&"value"in e?e.value:!e||"object"!=typeof e||globalThis.Node&&e instanceof globalThis.Node||!("value"in e)?e:e.value,l=(e,t)=>{let r=e;for(const n of t){if(!n)continue;if(r=a(r),null==r)return;r=r[n.startsWith("[")?n.slice(1,-1):n]}return a(r)},u=(e,t)=>{let r=e;for(let n=0;n<t.length;n++){const e=t[n];if(!e)continue;const i=e.startsWith("[")?e.slice(1,-1):e,s=a(r);if(null==s)return;if(n===t.length-1)return new o(s,i);r=s[i]}return r},c=(e,t)=>{if("string"!=typeof e)return e;const r=s();if("."===e)return a(t);if(e.startsWith("$/")){const[t,...n]=e.slice(2).split("/"),i=null==r?void 0:r.get(t);if(!i)return;return l(i,n)}if(e.startsWith("./"))return l(t,e.slice(2).split("/"));if(e.startsWith("../"))return l(null==t?void 0:t.__parent__,e.slice(3).split("/"));if(e.includes("/")||e.includes("."))return l(t,e.split(/[\/.]/));const n=a(t);return n&&"object"==typeof n&&(e in n||void 0!==n[e])?l(n,[e]):e},f=(e,t)=>{if("string"!=typeof e)return e;const r=s();if("."===e)return t;if(e.startsWith("$/")){const t=e.slice(2).split(/[\/.]/),n=t.shift(),i=null==r?void 0:r.get(n);if(!i)return;return u(i,t)}if(e.startsWith("./"))return u(t,e.slice(2).split(/[\/.]/));if(e.startsWith("../"))return u(null==t?void 0:t.__parent__,e.slice(3).split(/[\/.]/));if(e.includes("/")||e.includes("."))return u(t,e.split(/[\/.]/));const n=a(t);return n&&"object"==typeof n&&/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(e)?new o(n,e):e};class h{constructor(e){this.fn=e,this.isLazy=!0}resolve(e){return this.fn(e)}}const p=(e,t,r=!1)=>{if(e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"'))return{value:e.slice(1,-1),isLiteral:!0};if(""!==e&&!isNaN(Number(e)))return{value:Number(e),isLiteral:!0};if("true"===e)return{value:!0,isLiteral:!0};if("false"===e)return{value:!1,isLiteral:!0};if("null"===e)return{value:null,isLiteral:!0};if("_"===e||e.startsWith("_/")||e.startsWith("_."))return{value:new h(t=>{if("_"===e)return t;const r=(e.startsWith("_."),e.slice(2));return c(r,t)}),isLazy:!0};if("$event"===e||e.startsWith("$event/")||e.startsWith("$event."))return{value:new h(t=>{if("$event"===e)return t;const r=(e.startsWith("$event."),e.slice(7));return c(r,t)}),isLazy:!0};if(e.includes("(")){let n=e;e.startsWith("/")?n="$"+e:!r||e.startsWith("$")||e.startsWith("./")||(n=`$/${e}`);const i=g(n,t);return i instanceof h?{value:i,isLazy:!0}:{value:i,isSignal:!1}}const n=e.endsWith("..."),i=n?e.slice(0,-3):e;let s;if(s=i.startsWith("/")?"$"+i:i.startsWith("$")||i.startsWith("./")||i.startsWith("../")?i:r?`$/${i}`:`./${i}`,n){const e=s.split("/"),r=e.pop(),n=e.join("/"),i=n?c(n,t):t,o=a(i);if(Array.isArray(o)){return{value:o.map(e=>{const t=a(e);return t&&t[r]}),isExplosion:!0}}if(o&&"object"==typeof o){const e=o[r];return{value:a(e),isExplosion:!0}}return{value:void 0,isExplosion:!0}}return{value:f(s,t),isExplosion:!1}},g=(e,n)=>{var i;if("string"!=typeof e)return e;const s=e.indexOf("(");if(-1!==s&&e.endsWith(")")){const o=e.slice(0,s).trim(),l=e.slice(s+1,-1),u=o.split("/");let c=u.pop().replace(/^\$/,"");""===c&&(u.length>0||"/"===o)&&(c="/");const g=u.join("/"),d=e.startsWith("$/")||e.startsWith("$");let y=n;g&&"$"!==g&&(y=f(g,n));const v=t.get(c);if(!v)return null==(i=globalThis.console)||i.warn(`LightviewCDOM: Helper "${c}" not found.`),e;const m=r.get(c)||{},b=[];let w="",A=0,_=null;for(let e=0;e<l.length;e++){const t=l[e];if(t===_)_=null;else if(_||"'"!==t&&'"'!==t)if(_||"("!==t)if(_||")"!==t){if(!_&&","===t&&0===A){b.push(w.trim()),w="";continue}}else A--;else A++;else _=t;w+=t}w&&b.push(w.trim());const N=[];let W=!1;for(let e=0;e<b.length;e++){const t=b[e],r=p(t,y,d&&("$"===g||!g));r.isLazy&&(W=!0);const n=!(m.pathAware&&0===e);let i=n?a(r.value):r.value;r.isExplosion&&Array.isArray(i)?N.push(...i.map(e=>n?a(e):e)):N.push(i)}if(W)return new h(e=>{const t=N.map((t,r)=>{const n=!(m.pathAware&&0===r),i=t instanceof h?t.resolve(e):t;return n?a(i):i});return v(...t)});const M=v(...N);return a(M)}return a(c(e,n))},d=(e,t)=>{const r=i();return r&&"string"==typeof e?r.computed(()=>g(e,t)):e},y=(...e)=>e.reduce((e,t)=>Number(e)+Number(t),0),v=(e,t)=>Number(e)-Number(t),m=(...e)=>e.reduce((e,t)=>Number(e)*Number(t),1),b=(e,t)=>Number(e)/Number(t),w=(e,t=0)=>Number(Math.round(e+"e"+t)+"e-"+t),A=e=>Math.ceil(e),_=e=>Math.floor(e),N=e=>Math.abs(e),W=(e,t)=>e%t,M=(e,t)=>Math.pow(e,t),S=e=>Math.sqrt(e),j=(e,t,r)=>e?t:r,L=(...e)=>e.every(Boolean),$=(...e)=>e.some(Boolean),E=e=>!e,D=(e,t)=>e===t,x=(e,t)=>e!==t,O=(...e)=>{const t=e[e.length-1];return e.slice(0,-1).join(t)},T=(...e)=>e.join(""),C=e=>String(e).toUpperCase(),k=e=>String(e).toLowerCase(),I=e=>String(e).trim(),z=e=>String(e).length,P=(e,t,r)=>String(e).replace(t,r),R=(e,t)=>String(e).split(t),B=e=>{const t=String(e);return t.charAt(0).toUpperCase()+t.slice(1)},q=e=>String(e).toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),J=(e,t)=>String(e).includes(t),F=(e,t)=>String(e).startsWith(t),H=(e,t)=>String(e).endsWith(t),U=(e,t)=>null!=e?e:t,G=(...e)=>e.length,V=(e,t)=>Array.isArray(e)?"function"==typeof t&&t.isLazy?e.filter(e=>t.resolve(e)):e.filter(e=>!!e):[],Z=(e,t)=>Array.isArray(e)?"string"==typeof t?e.map(e=>e&&"object"==typeof e?e[t]:e):t&&t.isLazy?e.map(e=>t.resolve(e)):e:[],K=(e,t)=>{if(Array.isArray(e))return t&&t.isLazy?e.find(e=>t.resolve(e)):e.find(e=>!!e)},Y=e=>Array.isArray(e)?[...new Set(e)]:[],Q=(e,t="asc")=>{if(!Array.isArray(e))return[];const r=[...e];return r.sort((e,r)=>e<r?"asc"===t?-1:1:e>r?"asc"===t?1:-1:0),r},X=e=>Array.isArray(e)?[...e].reverse():[],ee=e=>Array.isArray(e)?e[0]:void 0,te=e=>Array.isArray(e)?e[e.length-1]:void 0,re=(e,t,r)=>Array.isArray(e)?e.slice(t,r):[],ne=e=>Array.isArray(e)?e.flat(1/0):[],ie=(e,t=",")=>Array.isArray(e)?e.join(String(t)):"",se=e=>Array.isArray(e)?e.length:e?String(e).length:0,oe=(e,t)=>e>t,ae=(e,t)=>e<t,le=(e,t)=>e>=t,ue=(e,t)=>e<=t,ce=(e,t)=>e!==t,fe=(e,t,r)=>e>=t&&e<=r,he=(e,t)=>Array.isArray(e)&&e.includes(t),pe=(e,t)=>{if(!Array.isArray(e))return 0;return(t&&t.isLazy?e.filter(e=>t.resolve(e)):e).reduce((e,t)=>e+(Number(t)||0),0)},ge=(e,t)=>Array.isArray(e)?t&&t.isLazy?e.filter(e=>t.resolve(e)).length:e.filter(e=>!!e).length:0,de=(e,t)=>{if(!Array.isArray(e))return 0;const r=t&&t.isLazy?e.filter(e=>t.resolve(e)):e;return 0===r.length?0:r.reduce((e,t)=>e+(Number(t)||0),0)/r.length},ye=()=>(new Date).getTime(),ve=()=>{const e=new Date;return e.setHours(0,0,0,0),e.getTime()},me=e=>new Date(e).getTime(),be=(e,t)=>{const r=new Date(e);if(isNaN(r.getTime()))return"";const n={year:"numeric",month:"2-digit",day:"2-digit"};return"long"===t&&(n.month="long"),r.toLocaleDateString(void 0,n)},we=e=>new Date(e).getFullYear(),Ae=e=>new Date(e).getMonth()+1,_e=e=>new Date(e).getDate(),Ne=e=>new Date(e).getDay(),We=(e,t)=>{const r=new Date(e);return r.setDate(r.getDate()+Number(t)),r.getTime()},Me=(e,t,r="days")=>{const n=Math.abs(new Date(e)-new Date(t));return"seconds"===r?n/1e3:"minutes"===r?n/6e4:"hours"===r?n/36e5:n/864e5},Se=(e,t=2)=>Number(e).toFixed(t),je=(e,t="$",r=2)=>t+Number(e).toFixed(r).replace(/\B(?=(\d{3})+(?!\d))/g,","),Le=(e,t=0)=>(100*Number(e)).toFixed(t)+"%",$e=e=>String(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),Ee=(e,t,r)=>{if(!Array.isArray(t))return;const n=t.indexOf(e);return-1!==n&&Array.isArray(r)?r[n]:void 0},De=(e,t,r)=>{if(!Array.isArray(t))return;const n=t.find(t=>Array.isArray(t)&&t[0]===e);return n?n[r-1]:void 0},xe=(e,t)=>Array.isArray(e)?e[t]:void 0,Oe=(e,t)=>Array.isArray(t)?t.indexOf(e):-1,Te=(...e)=>e.reduce((e,t)=>e+(Number(t)||0),0),Ce=(...e)=>0===e.length?0:Te(...e)/e.length,ke=(...e)=>Math.min(...e),Ie=(...e)=>Math.max(...e),ze=(...e)=>{if(0===e.length)return 0;const t=[...e].sort((e,t)=>e-t),r=Math.floor(t.length/2);return t.length%2!=0?t[r]:(t[r-1]+t[r])/2},Pe=(...e)=>{if(0===e.length)return 0;const t=Ce(...e),r=e.map(e=>Math.pow(e-t,2));return Math.sqrt(Ce(...r))},Re=(...e)=>{if(0===e.length)return 0;const t=Ce(...e),r=e.map(e=>Math.pow(e-t,2));return Ce(...r)},Be=(e,t)=>(e&&"object"==typeof e&&"value"in e||e&&"function"==typeof e&&"value"in e?e.value=t:e&&"object"==typeof e&&t&&"object"==typeof t&&Object.assign(e,t),t),qe=(e,t=1)=>{const r=e&&"object"==typeof e&&"value"in e?e.value:0,n=Number(r)+Number(t);return Be(e,n)},Je=(e,t=1)=>{const r=e&&"object"==typeof e&&"value"in e?e.value:0,n=Number(r)-Number(t);return Be(e,n)},Fe=e=>{const t=!(!e||"object"!=typeof e||!("value"in e))&&e.value;return Be(e,!t)},He=(e,t)=>{const r=e&&"object"==typeof e&&"value"in e?e.value:[];if(Array.isArray(r)){const n=[...r,t];return Be(e,n)}return r},Ue=e=>{const t=e&&"object"==typeof e&&"value"in e?e.value:[];if(Array.isArray(t)&&t.length>0){const r=t.slice(0,-1);Be(e,r)}return t},Ge=(e,t)=>{const r={...e&&"object"==typeof e&&"value"in e?e.value:{},...t};return Be(e,r)},Ve=e=>{const t=e&&"object"==typeof e&&"value"in e?e.value:null;return Array.isArray(t)?Be(e,[]):Be(e,"object"==typeof t&&null!==t?{}:null)},Ze=(e,t={})=>{const r={...t},n={...r.headers};let i=r.body;return void 0!==i&&(null!==i&&"object"==typeof i?(i=JSON.stringify(i),n["Content-Type"]||(n["Content-Type"]="application/json")):(i=String(i),n["Content-Type"]||(n["Content-Type"]="text/plain"))),r.body=i,r.headers=n,globalThis.fetch(e,r)},Ke=globalThis.__LIGHTVIEW_INTERNALS__||(globalThis.__LIGHTVIEW_INTERNALS__={currentEffect:null,registry:new Map,dependencyMap:new WeakMap}),Ye=(e,t)=>{let r="string"==typeof t?t:null==t?void 0:t.name;const n=null==t?void 0:t.storage;if(r&&n)try{const t=n.getItem(r);null!==t&&(e=JSON.parse(t))}catch(a){}let i=e;const s=new Set,o=(...e)=>{if(0===e.length)return o.value;o.value=e[0]};if(Object.defineProperty(o,"value",{get:()=>(Ke.currentEffect&&(s.add(Ke.currentEffect),Ke.currentEffect.dependencies.add(s)),i),set(e){if(i!==e){if(i=e,r&&n)try{n.setItem(r,JSON.stringify(i))}catch(a){}[...s].forEach(e=>e())}}}),r)if(Ke.registry.has(r)){if(Ke.registry.get(r)!==o)throw new Error(`Lightview: A signal or state with the name "${r}" is already registered.`)}else Ke.registry.set(r,o);return o};Ye.get=(e,t)=>Ke.registry.has(e)||void 0===t?Ke.registry.get(e):Ye(t,e);const Qe=e=>{const t=()=>{if(t.active&&!t.running){t.dependencies.forEach(e=>e.delete(t)),t.dependencies.clear(),t.running=!0,Ke.currentEffect=t;try{e()}finally{Ke.currentEffect=null,t.running=!1}}};return t.active=!0,t.running=!1,t.dependencies=new Set,t.stop=()=>{t.dependencies.forEach(e=>e.delete(t)),t.dependencies.clear(),t.active=!1},t(),t},Xe=()=>Ke.registry,et=new WeakMap,tt=new WeakMap,rt=new WeakMap,nt=(e,t)=>Object.getOwnPropertyNames(e).filter(r=>"function"==typeof e[r]&&t(r)),it=nt(Date.prototype,e=>/^(to|get|valueOf)/.test(e)),st=nt(Date.prototype,e=>/^set/.test(e)),ot=["map","forEach","filter","find","findIndex","some","every","reduce","reduceRight","includes","indexOf","lastIndexOf","join","slice","concat","flat","flatMap","at","entries","keys","values"],at=["push","pop","shift","unshift","splice","sort","reverse","fill","copyWithin"],lt=["map","forEach","filter","find","findIndex","some","every","flatMap"],ut=(e,t,r)=>{let n=e.get(t);return n||(n=r(),e.set(t,n)),n},ct=(e,t,r,n)=>{if("__parent__"===t)return rt.get(r);n.has(t)||n.set(t,Ye(Reflect.get(e,t,r)));const i=n.get(t).value;if("object"==typeof i&&null!==i){const e=pt(i);return rt.set(e,r),e}return i},ft=(e,t,r,n,i)=>{i.has(t)||i.set(t,Ye(Reflect.get(e,t,n)));const s=Reflect.set(e,t,r,n),o=i.get(t);return s&&o&&(o.value=r),s},ht=(e,t,r=[])=>{const n=ut(tt,e,()=>new Map);if(!n.has(t)){const r="function"==typeof e[t]?e[t].call(e):e[t];n.set(t,Ye(r))}const i=e instanceof Date,s=Array.isArray(e),o=i?it:s?ot:r,a=i?st:s?at:[];return new Proxy(e,{get(e,r,i){if("__parent__"===r)return rt.get(i);const l=e[r];if("function"==typeof l){const u=o.includes(r),c=a.includes(r);return function(...o){if(u){const e=n.get(t);e&&e.value}const a="function"==typeof e[t]?e[t].call(e):e[t];if(s&&lt.includes(r)&&"function"==typeof o[0]){const e=o[0];o[0]=function(t,r,n){const s="object"==typeof t&&null!==t?pt(t):t;return s&&"object"==typeof s&&rt.set(s,i),e.call(this,s,r,n)}}const f=l.apply(e,o),h="function"==typeof e[t]?e[t].call(e):e[t];if(a!==h||c){const e=n.get(t);e&&e.value!==h&&(e.value=h)}return f}}if(r===t){const s=n.get(t);return s?s.value:Reflect.get(e,r,i)}if(s&&!isNaN(parseInt(r))){const e=n.get(t);e&&e.value}return ct(e,r,i,n)},set(e,r,i,s){if(r===t){const o=Reflect.set(e,r,i,s);if(o){const e=n.get(t);e&&(e.value=i)}return o}return ft(e,r,i,s,n)}})},pt=(e,t)=>{if("object"!=typeof e||null===e)return e;const r="string"==typeof t?t:null==t?void 0:t.name,n=null==t?void 0:t.storage;if(r&&n)try{const t=n.getItem(r);if(t){const r=JSON.parse(t);Array.isArray(e)&&Array.isArray(r)?(e.length=0,e.push(...r)):Object.assign(e,r)}}catch(s){}let i=et.get(e);if(!i){const t=Array.isArray(e),r=e instanceof Date,n=t||r;if(!n&&(e instanceof RegExp||e instanceof Map||e instanceof Set||e instanceof WeakMap||e instanceof WeakSet))return e;i=n?ht(e,t?"length":r?"getTime":null):new Proxy(e,{get:(e,t,r)=>"__parent__"===t?rt.get(r):ct(e,t,r,ut(tt,e,()=>new Map)),set:(e,t,r,n)=>ft(e,t,r,n,ut(tt,e,()=>new Map))}),et.set(e,i)}if(r&&n&&Qe(()=>{try{n.setItem(r,JSON.stringify(i))}catch(s){}}),r){const e=Xe();if(e.has(r)){if(e.get(r)!==i)throw new Error(`Lightview: A signal or state with the name "${r}" is already registered.`)}else e.set(r,i)}return i};var gt;pt.get=(e,t)=>{const r=Xe();return r.has(e)||void 0===t?r.get(e):pt(t,e)},(gt=n)("+",y),gt("add",y),gt("-",v),gt("sub",v),gt("*",m),gt("mul",m),gt("/",b),gt("div",b),gt("round",w),gt("ceil",A),gt("floor",_),gt("abs",N),gt("mod",W),gt("pow",M),gt("sqrt",S),(e=>{e("if",j),e("and",L),e("&&",L),e("or",$),e("||",$),e("not",E),e("!",E),e("eq",D),e("==",D),e("===",D),e("neq",x)})(n),(e=>{e("join",O),e("concat",T),e("upper",C),e("lower",k),e("trim",I),e("len",z),e("replace",P),e("split",R),e("capitalize",B),e("titleCase",q),e("contains",J),e("startsWith",F),e("endsWith",H),e("default",U)})(n),(e=>{e("count",G),e("filter",V),e("map",Z),e("find",K),e("unique",Y),e("sort",Q),e("reverse",X),e("first",ee),e("last",te),e("slice",re),e("flatten",ne),e("join",ie),e("len",se),e("length",se)})(n),(e=>{e("gt",oe),e(">",oe),e("lt",ae),e("<",ae),e("gte",le),e(">=",le),e("lte",ue),e("<=",ue),e("neq",ce),e("!=",ce),e("between",fe),e("in",he)})(n),(e=>{e("sumIf",pe),e("countIf",ge),e("avgIf",de)})(n),(e=>{e("now",ye),e("today",ve),e("date",me),e("formatDate",be),e("year",we),e("month",Ae),e("day",_e),e("weekday",Ne),e("addDays",We),e("dateDiff",Me)})(n),(e=>{e("number",Se),e("currency",je),e("percent",Le),e("thousands",$e)})(n),(e=>{e("lookup",Ee),e("vlookup",De),e("index",xe),e("match",Oe)})(n),(e=>{e("sum",Te),e("avg",Ce),e("min",ke),e("max",Ie),e("median",ze),e("stdev",Pe),e("var",Re)})(n),(e=>{const t={pathAware:!0};e("set",Be,t),e("increment",qe,t),e("++",qe,t),e("decrement",Je,t),e("--",Je,t),e("toggle",Fe,t),e("!!",Fe,t),e("push",He,t),e("pop",Ue,t),e("assign",Ge,t),e("clear",Ve,t)})((e,t)=>n(e,t,{pathAware:!0})),(e=>{e("fetch",Ze)})(n);const dt=new WeakMap,yt=(e,t=null)=>{const r=[];let n=e;const i=globalThis.ShadowRoot;for(;n;){const e=dt.get(n);e&&r.unshift(e),n=n.parentElement||(i&&n.parentNode instanceof i?n.parentNode.host:null)}const s=Xe();return new Proxy({},{get(e,n,i){var o;if("$event"===n||"event"===n)return t;if("__parent__"===n)return;for(let t=r.length-1;t>=0;t--){const e=r[t];if(n in e)return e[n]}if(s&&s.has(n))return s.get(n);const a=null==(o=globalThis.Lightview)?void 0:o.state;return a&&n in a?a[n]:void 0},set(e,t,n,i){var s;for(let a=r.length-1;a>=0;a--){const e=r[a];if(t in e)return e[t]=n,!0}if(r.length>0)return r[r.length-1][t]=n,!0;const o=null==(s=globalThis.Lightview)?void 0:s.state;return!!o&&(o[t]=n,!0)},has(e,n){var i;if("$event"===n||"event"===n)return!!t;for(const t of r)if(n in t)return!0;const s=null==(i=globalThis.Lightview)?void 0:i.state;return!(!s||!(n in s))},ownKeys(e){var n;const i=new Set;t&&(i.add("$event"),i.add("event"));for(const t of r)for(const e in t)i.add(e);const s=null==(n=globalThis.Lightview)?void 0:n.state;if(s)for(const t in s)i.add(t);return Array.from(i)},getOwnPropertyDescriptor:(e,t)=>({enumerable:!0,configurable:!0})})},vt=e=>{var t;const r=e.getAttribute("cdom-state");if(r&&!dt.has(e))try{const t=JSON.parse(r),n=pt(t);dt.set(e,n)}catch(n){null==(t=globalThis.console)||t.error("LightviewCDOM: Failed to parse cdom-state",n)}},mt=e=>{const t=e.getAttribute("cdom-bind");if(!t)return;const r=e.type||"",n=e.tagName.toLowerCase();let i="value",s="input";"checkbox"===r||"radio"===r?(i="checked",s="change"):"select"===n&&(s="change");const o=yt(e);let l=f(t,o);if(l&&l.isBindingTarget&&void 0===l.value){const r=e[i];void 0!==r&&""!==r&&(Be(o,{[l.key]:r}),l=f(t,o))}Qe(()=>{const t=a(l);e[i]!==t&&(e[i]=void 0===t?"":t)}),e.addEventListener(s,()=>{const r=e[i];l&&l.isBindingTarget?l.value=r:Be(o,{[t]:r})})},bt=e=>{Array.from(e.attributes).forEach(t=>{if(t.name.startsWith("cdom-on:")){const r=t.name.slice(8),n=t.value;e.addEventListener(r,t=>{const r=yt(e,t),i=g(n,r);i&&"object"==typeof i&&i.isLazy&&"function"==typeof i.resolve&&i.resolve(t)})}})},wt=(e=document.body)=>{const t=e=>{1===e.nodeType&&(e.hasAttribute("cdom-state")&&vt(e),e.hasAttribute("cdom-bind")&&mt(e),bt(e));let r=e.firstChild;for(;r;)t(r),r=r.nextSibling};t(e)},At=(e,t=null)=>{if(!e)return e;if("string"==typeof e&&e.startsWith("$"))return d(e,t);if(Array.isArray(e))return e.map(e=>At(e,t));if(e instanceof String)return e.toString();if("object"==typeof e&&null!==e){t&&!("__parent__"in e)&&Object.defineProperty(e,"__parent__",{value:t,enumerable:!1,writable:!0,configurable:!0});for(const t in e)e[t]=At(e[t],e);return e}return e},_t={registerHelper:n,parseExpression:d,resolvePath:c,resolvePathAsContext:f,resolveExpression:g,parseCDOMC:e=>{let t=0;const r=e.length,n=()=>{for(;t<r;){const n=e[t];if(!/\s/.test(n)){if("/"===n){const n=e[t+1];if("/"===n){for(t+=2;t<r&&"\n"!==e[t]&&"\r"!==e[t];)t++;continue}if("*"===n){for(t+=2;t<r;){if("*"===e[t]&&"/"===e[t+1]){t+=2;break}t++}continue}}break}t++}},i=()=>{const n=e[t++];let i="";for(;t<r;){const r=e[t++];if(r===n)return new String(i);if("\\"===r){const r=e[t++];i+="n"===r?"\n":"t"===r?"\t":'"'===r?'"':"'"===r?"'":"\\"===r?"\\":r}else i+=r}throw new Error("Unterminated string")},s=()=>{const n=t;let i=0;for(;t<r;){const r=e[t];if(i>0)")"===r?i--:"("===r&&i++,t++;else{if(/[\s:,{}\[\]"'`()]/.test(r)){if("("===r){i++,t++;continue}break}t++}}const s=e.slice(n,t);return"true"===s||"false"!==s&&("null"===s?null:""===s.trim()||isNaN(Number(s))?s:Number(s))},o=()=>{if(n(),t>=r)return;const o=e[t];return"{"===o?a():"["===o?l():'"'===o||"'"===o?i():s()},a=()=>{t++;const a={};if(n(),t<r&&"}"===e[t])return t++,a;for(;t<r;){let r;if(n(),r='"'===e[t]||"'"===e[t]?i():s(),n(),":"!==e[t])throw new Error(`Expected ':' at position ${t}, found '${e[t]}'`);t++;const l=o();if(a[String(r)]=l,n(),"}"===e[t])return t++,a;if(","!==e[t])throw new Error(`Expected '}' or ',' at position ${t}, found '${e[t]}'`);if(t++,n(),"}"===e[t])return t++,a}},l=()=>{t++;const i=[];if(n(),t<r&&"]"===e[t])return t++,i;for(;t<r;){const r=o();if(i.push(r),n(),"]"===e[t])return t++,i;if(","!==e[t])throw new Error(`Expected ']' or ',' at position ${t}, found '${e[t]}'`);if(t++,n(),"]"===e[t])return t++,i}};n();return o()},unwrapSignal:a,getContext:yt,handleCDOMState:vt,handleCDOMBind:mt,handleCDOMOn:bt,activate:wt,hydrate:At,version:"1.0.0"};return"undefined"!=typeof window&&(globalThis.LightviewCDOM=_t),e.activate=wt,e.default=_t,e.getContext=yt,e.handleCDOMBind=mt,e.handleCDOMOn=bt,e.handleCDOMState=vt,e.hydrate=At,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),e}({});
