!function(){"use strict";const e=globalThis.__LIGHTVIEW_INTERNALS__||(globalThis.__LIGHTVIEW_INTERNALS__={currentEffect:null,registry:new Map,dependencyMap:new WeakMap}),t=(t,n)=>{let r="string"==typeof n?n:null==n?void 0:n.name;const o=null==n?void 0:n.storage;if(r&&o)try{const e=o.getItem(r);null!==e&&(t=JSON.parse(e))}catch(l){}let s=t;const i=new Set,a=(...e)=>{if(0===e.length)return a.value;a.value=e[0]};if(Object.defineProperty(a,"value",{get:()=>(e.currentEffect&&(i.add(e.currentEffect),e.currentEffect.dependencies.add(i)),s),set(e){if(s!==e){if(s=e,r&&o)try{o.setItem(r,JSON.stringify(s))}catch(l){}[...i].forEach(e=>e())}}}),r)if(e.registry.has(r)){if(e.registry.get(r)!==a)throw new Error(`Lightview: A signal or state with the name "${r}" is already registered.`)}else e.registry.set(r,a);return a};t.get=(n,r)=>e.registry.has(n)||void 0===r?e.registry.get(n):t(r,n);const n=t=>{const n=()=>{if(n.active&&!n.running){n.dependencies.forEach(e=>e.delete(n)),n.dependencies.clear(),n.running=!0,e.currentEffect=n;try{t()}finally{e.currentEffect=null,n.running=!1}}};return n.active=!0,n.running=!1,n.dependencies=new Set,n.stop=()=>{n.dependencies.forEach(e=>e.delete(n)),n.dependencies.clear(),n.active=!1},n(),n},r=()=>e.registry,o=new WeakMap,s=new WeakMap,i=new WeakMap,a=(e,t)=>Object.getOwnPropertyNames(e).filter(n=>"function"==typeof e[n]&&t(n)),l=a(Date.prototype,e=>/^(to|get|valueOf)/.test(e)),c=a(Date.prototype,e=>/^set/.test(e)),u=["map","forEach","filter","find","findIndex","some","every","reduce","reduceRight","includes","indexOf","lastIndexOf","join","slice","concat","flat","flatMap","at","entries","keys","values"],d=["push","pop","shift","unshift","splice","sort","reverse","fill","copyWithin"],h=["map","forEach","filter","find","findIndex","some","every","flatMap"],f=(e,t,n)=>{let r=e.get(t);return r||(r=n(),e.set(t,r)),r},p=(e,n,r,o)=>{if("__parent__"===n)return i.get(r);o.has(n)||o.set(n,t(Reflect.get(e,n,r)));const s=o.get(n).value;if("object"==typeof s&&null!==s){const e=y(s);return i.set(e,r),e}return s},m=(e,n,r,o,s)=>{s.has(n)||s.set(n,t(Reflect.get(e,n,o)));const i=Reflect.set(e,n,r,o),a=s.get(n);return i&&a&&(a.value=r),i},g=(e,n,r=[])=>{const o=f(s,e,()=>new Map);if(!o.has(n)){const r="function"==typeof e[n]?e[n].call(e):e[n];o.set(n,t(r))}const a=e instanceof Date,g=Array.isArray(e),v=a?l:g?u:r,b=a?c:g?d:[];return new Proxy(e,{get(e,t,r){if("__parent__"===t)return i.get(r);const s=e[t];if("function"==typeof s){const a=v.includes(t),l=b.includes(t);return function(...c){if(a){const e=o.get(n);e&&e.value}const u="function"==typeof e[n]?e[n].call(e):e[n];if(g&&h.includes(t)&&"function"==typeof c[0]){const e=c[0];c[0]=function(t,n,o){const s="object"==typeof t&&null!==t?y(t):t;return s&&"object"==typeof s&&i.set(s,r),e.call(this,s,n,o)}}const d=s.apply(e,c),f="function"==typeof e[n]?e[n].call(e):e[n];if(u!==f||l){const e=o.get(n);e&&e.value!==f&&(e.value=f)}return d}}if(t===n){const s=o.get(n);return s?s.value:Reflect.get(e,t,r)}if(g&&!isNaN(parseInt(t))){const e=o.get(n);e&&e.value}return p(e,t,r,o)},set(e,t,r,s){if(t===n){const i=Reflect.set(e,t,r,s);if(i){const e=o.get(n);e&&(e.value=r)}return i}return m(e,t,r,s,o)}})},y=(e,t)=>{if("object"!=typeof e||null===e)return e;const a="string"==typeof t?t:null==t?void 0:t.name,l=null==t?void 0:t.storage;if(a&&l)try{const t=l.getItem(a);if(t){const n=JSON.parse(t);Array.isArray(e)&&Array.isArray(n)?(e.length=0,e.push(...n)):Object.assign(e,n)}}catch(u){}let c=o.get(e);if(!c){const t=Array.isArray(e),n=e instanceof Date,r=t||n;if(!r&&(e instanceof RegExp||e instanceof Map||e instanceof Set||e instanceof WeakMap||e instanceof WeakSet))return e;c=r?g(e,t?"length":n?"getTime":null):new Proxy(e,{get:(e,t,n)=>"__parent__"===t?i.get(n):p(e,t,n,f(s,e,()=>new Map)),set:(e,t,n,r)=>m(e,t,n,r,f(s,e,()=>new Map))}),o.set(e,c)}if(a&&l&&n(()=>{try{l.setItem(a,JSON.stringify(c))}catch(u){}}),a){const e=r();if(e.has(a)){if(e.get(a)!==c)throw new Error(`Lightview: A signal or state with the name "${a}" is already registered.`)}else e.set(a,c)}return c};y.get=(e,t)=>{const n=r();return n.has(e)||void 0===t?n.get(e):y(t,e)};const v={get currentEffect(){return(globalThis.__LIGHTVIEW_INTERNALS__||(globalThis.__LIGHTVIEW_INTERNALS__={})).currentEffect}},b=new WeakMap,w=()=>({effects:[],onmount:null,onunmount:null}),E=r(),S=(e,t)=>{const n=f(b,e,w);n.effects||(n.effects=[]),n.effects.push(t)},A=Symbol("lightview.shadowDOM"),T=e=>e&&"object"==typeof e&&!0===e[A],L=(e,t)=>{if(t.shadowRoot)return void console.warn("Lightview: Element already has a shadowRoot, skipping shadowDOM directive");const n=t.attachShadow({mode:e.mode}),r=[],o=[...e.styles||[]];if(e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&e.adoptedStyleSheets.forEach(e=>{e instanceof CSSStyleSheet?r.push(e):"string"==typeof e&&o.push(e)}),r.length>0)try{n.adoptedStyleSheets=r}catch(s){console.warn("Lightview: adoptedStyleSheets not supported")}for(const i of o){const e=document.createElement("link");e.rel="stylesheet",e.href=i,n.appendChild(e)}e.children&&e.children.length>0&&D(e.children,n)};let C=!1;const N=new WeakMap,O=(e,t,n={},r=[])=>{const o=_({tag:t,attributes:n,children:r,get domEl(){return e}});return N.set(e,o),o},M=(e,t={},r=[])=>{if(R[e]&&(e=R[e]),"function"==typeof e){const n=e({...t},r);return k(n)}if("shadowDOM"===e)return((e,t)=>({[A]:!0,mode:e.mode||"open",styles:e.styles||[],adoptedStyleSheets:e.adoptedStyleSheets||[],children:t}))(t,r);if("text"===e&&!C){const o=document.createTextNode(""),s={tag:e,attributes:t,children:r,get domEl(){return o}},i=()=>{const e=(Array.isArray(s.children)?s.children:[s.children]).flat(1/0).map(e=>{const t="function"==typeof e?e():e;return t&&"object"==typeof t&&t.domEl?t.domEl.textContent:null==t?"":String(t)});o.textContent=e.join(" ")},a=new Proxy(s,{set:(e,t,n)=>(e[t]=n,"children"===t&&i(),!0)});if(r.flat(1/0).some(e=>"function"==typeof e)){const e=n(i);S(o,e)}return i(),a}const o="svg"===e.toLowerCase(),s=C;o&&(C=!0);const i=C?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e),a=O(i,e,t,r);return a.attributes=t,a.children=r,o&&(C=s),a},k=e=>{if(!e)return null;if(F.hooks.processChild&&(e=F.hooks.processChild(e)??e),e.domEl)return e;const t=typeof e;if("object"===t&&e instanceof HTMLElement)return O(e,e.tagName.toLowerCase(),{},[]);if("object"===t&&e instanceof String){const t=document.createElement("span");return t.textContent=e.toString(),O(t,"span",{},[])}if("string"===t){const t=document.createElement("template");t.innerHTML=e.trim();const n=t.content;if(1===n.childNodes.length&&n.firstChild instanceof HTMLElement){const e=n.firstChild;return O(e,e.tagName.toLowerCase(),{},[])}{const e=document.createElement("span");return e.style.display="contents",e.appendChild(n),O(e,"span",{},[])}}return"object"==typeof e&&e.tag?M(e.tag,e.attributes||{},e.children||[]):null},_=e=>{const t=e.domEl;return new Proxy(e,{set:(e,n,r)=>(e[n]="attributes"===n?$(r,t):"children"===n?I(r,t):r,!0)})},W=new Set(["value","checked","selected","selectedIndex","className","innerHTML","innerText"]),x=(e,t,n)=>{const r="boolean"==typeof e[t];"href"!==t&&"src"!==t||"string"!=typeof n||!/^(javascript|vbscript|data:text\/html|data:application\/javascript)/i.test(n)||(console.warn(`[Lightview] Blocked dangerous protocol in ${t}: ${n}`),n="javascript:void(0)"),W.has(t)||r?e[t]=r?null!=n&&!1!==n&&"false"!==n:n:null==n?e.removeAttribute(t):e.setAttribute(t,n)},$=(e,t)=>{const r={};for(let[o,s]of Object.entries(e))if("onmount"===o||"onunmount"===o){f(b,t,w)[o]=s,"onmount"===o&&t.isConnected&&s(t)}else if(o.startsWith("on")){if("function"==typeof s){const e=o.slice(2).toLowerCase();t.addEventListener(e,s)}else"string"==typeof s&&t.setAttribute(o,s);r[o]=s}else if("function"==typeof s){const e=n(()=>{const e=s();"style"===o&&"object"==typeof e?Object.assign(t.style,e):x(t,o,e)});S(t,e),r[o]=s}else"style"===o&&"object"==typeof s?(Object.entries(s).forEach(([e,r])=>{if("function"==typeof r){const o=n(()=>{t.style[e]=r()});S(t,o)}else t.style[e]=r}),r[o]=s):(x(t,o,s),r[o]=s);return r},j=(e,t,r=!0)=>{r&&void 0!==t.innerHTML&&(t.innerHTML="");const o=[],s=t.tagName&&("script"===t.tagName.toLowerCase()||"style"===t.tagName.toLowerCase()),i=e.flat(1/0);for(let a of i){if(F.hooks.processChild&&!s&&(a=F.hooks.processChild(a)??a),T(a)){if(t instanceof ShadowRoot){console.warn("Lightview: Cannot nest shadowDOM inside another shadowDOM");continue}L(a,t);continue}const e=typeof a;if("function"===e){const e=document.createComment("lv:s"),r=document.createComment("lv:e");let s;t.appendChild(e),t.appendChild(r);const i=()=>{for(;e.nextSibling&&e.nextSibling!==r;)e.nextSibling.remove();const t=a();if(null!=t)if(!s||e.isConnected)if("object"==typeof t&&t instanceof String){const e=document.createTextNode(t);r.parentNode.insertBefore(e,r)}else{const e=document.createDocumentFragment(),n=Array.isArray(t)?t:[t];j(n,e,!1),r.parentNode.insertBefore(e,r)}else s.stop()};s=n(i),S(e,s),o.push(a)}else if(["string","number","boolean","symbol"].includes(e)||a&&"object"===e&&a instanceof String)t.appendChild(document.createTextNode(a)),o.push(a);else if(a&&"object"===e&&a.tag){const e=a.domEl?a:M(a.tag,a.attributes||{},a.children||[]);t.appendChild(e.domEl),o.push(e)}}return o},D=(e,t)=>j(e,t,!1),I=(e,t)=>j(e,t,!0),R={},P=new Proxy({},{get(e,t){if("_customTags"===t)return{...R};const n=(...e)=>{let n={},r=e;const o=e[0];return e.length>0&&o&&"object"==typeof o&&!o.tag&&!o.domEl&&!Array.isArray(o)&&(n=o,r=e.slice(1)),M(R[t]||t,n,r)};return R[t]&&Object.assign(n,R[t]),n},set:(e,t,n)=>(R[t]=n,!0)}),F={signal:t,computed:e=>{const r=t(void 0);return n(()=>{r.value=e()}),r},effect:n,registry:E,element:M,enhance:(e,t={})=>{const r="string"==typeof e?document.querySelector(e):e,o=r.domEl||r;if(!(o instanceof HTMLElement))return null;const s=o.tagName.toLowerCase();let i=N.get(o);i||(i=O(o,s));const{innerText:a,innerHTML:l,...c}=t;return void 0!==a&&("function"==typeof a?n(()=>{o.innerText=a()}):o.innerText=a),void 0!==l&&("function"==typeof l?n(()=>{o.innerHTML=l()}):o.innerHTML=l),Object.keys(c).length>0&&(i.attributes=c),i},tags:P,$:(e,t=document.body)=>{const n="string"==typeof e?t.querySelector(e):e;return n?(Object.defineProperty(n,"content",{value(e,t="inner"){t=t.toLowerCase(),F.tags;const r=n.tagName&&("script"===n.tagName.toLowerCase()||"style"===n.tagName.toLowerCase()),o=(Array.isArray(e)?e:[e]).map(e=>(F.hooks.processChild&&!r&&(e=F.hooks.processChild(e)??e),e.tag&&!e.domEl?M(e.tag,e.attributes||{},e.children||[]).domEl:e.domEl||e)),s="shadow"===t?n.shadowRoot||n.attachShadow({mode:"open"}):n;return"inner"===t||"shadow"===t?s.replaceChildren(...o):"outer"===t?s.replaceWith(...o):"afterbegin"===t?s.prepend(...o):"beforeend"===t?s.append(...o):o.forEach(e=>n.insertAdjacentElement(t,e)),n},configurable:!0,writable:!0}),n):null},hooks:{onNonStandardHref:null,processChild:null,validateUrl:null},internals:{core:v,domToElement:N,wrapDomElement:O,setupChildren:I}};if("undefined"!=typeof module&&module.exports&&(module.exports=F),"undefined"!=typeof window&&(globalThis.Lightview=F,globalThis.addEventListener("click",e=>{const t=e.composedPath().find(e=>{var t,n;return"A"===e.tagName&&(null==(n=null==(t=e.getAttribute)?void 0:t.call(e,"href"))?void 0:n.startsWith("#"))});if(t&&!e.defaultPrevented){const n=t.getAttribute("href");if(n.length>1){const r=n.slice(1),o=t.getRootNode(),s=(o.getElementById?o.getElementById(r):null)||(o.querySelector?o.querySelector(`#${r}`):null);s&&(e.preventDefault(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{s.style.scrollMarginTop="calc(var(--site-nav-height, 0px) + 2rem)",s.scrollIntoView({behavior:"smooth",block:"start",inline:"start"})})}))}}F.hooks.onNonStandardHref&&F.hooks.onNonStandardHref(e)}),"undefined"!=typeof MutationObserver)){const e=(t,n)=>{var r;n(t),null==(r=t.childNodes)||r.forEach(t=>e(t,n)),t.shadowRoot&&e(t.shadowRoot,n)},t=t=>e(t,e=>{var t,n;const r=b.get(e);r&&(null==(t=r.effects)||t.forEach(e=>e.stop()),null==(n=r.onunmount)||n.call(r,e),b.delete(e))}),n=t=>e(t,e=>{var t,n;null==(n=null==(t=b.get(e))?void 0:t.onmount)||n.call(t,e)}),r=new MutationObserver(e=>{e.forEach(e=>{e.removedNodes.forEach(t),e.addedNodes.forEach(n)})}),o=()=>{document.body&&r.observe(document.body,{childList:!0,subtree:!0})};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()}const H=["img","script","iframe","video","audio","source","track","embed","input"],q=["a","area","base","link"],U=e=>{if(!e||"string"!=typeof e)return!1;const t=e.trim().toLowerCase();return t.startsWith("javascript:")||t.startsWith("vbscript:")||t.startsWith("data:text/html")||t.startsWith("data:application/javascript")},B=e=>{if(!e)return!1;if(!/^[a-z][a-z0-9+.-]*:/i.test(e))return!0;try{const t="undefined"!=typeof document?document.baseURI:globalThis.location.origin,n=new URL(e,"null"===t?void 0:t),r=globalThis.location;return n.origin===r.origin&&"null"!==n.origin||(!(!n.hostname||n.hostname!==r.hostname)||(!!(n.hostname&&r.hostname&&n.hostname.endsWith("."+r.hostname))||"file:"===r.protocol&&"file:"===n.protocol))}catch(t){return!1}},z=e=>{var t,n;if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return e.map(z);if(e.tag)return{...e,children:e.children?z(e.children):[]};if(e.domEl||!(e=>{if("object"!=typeof e||null===e||Array.isArray(e)||e.tag||e.domEl)return!1;const t=Object.keys(e);return 1===t.length&&"string"==typeof(n=t[0])&&n.length>0&&"children"!==n&&"object"==typeof e[t[0]];var n})(e))return e;const r=Object.keys(e)[0],o=e[r],s="undefined"!=typeof window||"undefined"!=typeof globalThis?globalThis.Lightview:null,i=(null==(n=null==(t=null==s?void 0:s.tags)?void 0:t._customTags)?void 0:n[r])||r,{children:a,...l}=o;return{tag:i,attributes:l,children:a?z(a):[]}},X="https://cdn.jsdelivr.net/npm/daisyui@3.9.4/dist/full.min.css",V={initialized:!1,shadowDefault:!0,daisyStyleSheet:null,themeStyleSheet:null,componentStyleSheets:new Map,customStyleSheets:new Map},J=async(e,t)=>{if(!V.customStyleSheets.has(e))try{let n=t;if(void 0===n)if(e.startsWith("#")){const t=document.querySelector(e);if(!t)throw new Error(`Style block '${e}' not found`);n=t.textContent}else{const t=await fetch(e);if(!t.ok)throw new Error(`Fetch failed: ${t.status}`);n=await t.text()}if(void 0!==n){const t=new CSSStyleSheet;t.replaceSync(n),V.customStyleSheets.set(e,t)}}catch(n){console.error(`LightviewX: Failed to register stylesheet '${e}':`,n)}},Y=()=>{try{if("undefined"!=typeof localStorage)return localStorage.getItem("lightview-theme")}catch(e){return null}},G=t("undefined"!=typeof document&&document.documentElement.getAttribute("data-theme")||Y()||"light"),Z=e=>{if(e){"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",e),G&&G.value!==e&&(G.value=e);try{"undefined"!=typeof localStorage&&localStorage.setItem("lightview-theme",e)}catch(t){}}},K=async(e={})=>{const{shadowDefault:t=!0}=e;if(V.shadowDefault=t,t)try{const e=await fetch(X);if(!e.ok)throw new Error(`Failed to fetch DaisyUI CSS: ${e.status}`);const t=await e.text(),n=new CSSStyleSheet;n.replaceSync(t),V.daisyStyleSheet=n}catch(n){console.error("LightviewX: Failed to preload DaisyUI stylesheet:",n)}V.initialized=!0};(async()=>{await K()})();const Q=(e,t=[])=>{const n=[];if(V.daisyStyleSheet?n.push(V.daisyStyleSheet):n.push(X),V.themeStyleSheet&&n.push(V.themeStyleSheet),e){const t=V.componentStyleSheets.get(e);t&&n.push(t)}return Array.isArray(t)&&t.forEach(e=>{const t=V.customStyleSheets.get(e);t?n.push(t):(J(e),n.push(e))}),n},ee=e=>{try{const t=e.trim().startsWith("${")&&e.trim().endsWith("}")&&!e.trim().includes("${",2)?"return "+e.trim().slice(2,-1):"return `"+e.replace(/\\/g,"\\\\").replace(/`/g,"\\`")+"`";return new Function("state","signal",t)}catch(t){return()=>""}},te=(e,t,n=null)=>{const r="script"===n||"style"===n,o=globalThis.Lightview;return e.map(e=>e.nodeType===Node.TEXT_NODE?((e,t,n)=>{const r=e.textContent;if(t)return r;if(!r.trim()&&!r.includes("${"))return null;if(r.includes("${")){const e=ee(r);return()=>e(n.state,n.signal)}return r})(e,r,o):e.nodeType===Node.ELEMENT_NODE?((e,t,n)=>{const r=e.tagName.toLowerCase(),o={},s="script"===r||"style"===r,i="undefined"!=typeof window||"undefined"!=typeof globalThis?globalThis.Lightview:null;for(let a of e.attributes){const e=a.value;o[a.name]=!s&&e.includes("${")?(()=>{const t=ee(e);return()=>t(i.state,i.signal)})():e}return t(r,o,n(Array.from(e.childNodes),t,r))})(e,t,te):null).filter(e=>null!==e)},ne=new WeakMap,re=(e,t=!1)=>document.createComment(`lv-src-${t?"end":"start"}:${e}`),oe=e=>{if(!e)return;e.querySelectorAll("script").forEach(e=>{const t=document.createElement("script");Array.from(e.attributes).forEach(e=>{t.setAttribute(e.name,e.value)}),e.src?t.src=e.src:t.textContent=e.textContent,e.parentNode.replaceChild(t,e)})},se=(e,t,n,r,o,s=!1,i="")=>{var a;if(t)return Array.isArray(e)?e:[e];if(s&&"cdomc"===i){const t=null==(a=globalThis.LightviewCDOM)?void 0:a.parseCDOMC;if(!t)return console.warn("LightviewX: CDOMC parser not found. Ensure lightview-cdom.js is loaded."),[];try{const n=t(e);return Array.isArray(n)?n:[n]}catch(l){return console.warn("LightviewX: Failed to parse .cdomc:",l),[]}}if(n){if("true"===r.domEl.getAttribute("escape"))return[e];const t=(new DOMParser).parseFromString(e.replace(/<head[^>]*>[\s\S]*?<\/head>/i,""),"text/html");return te([...Array.from(t.head.childNodes),...Array.from(t.body.childNodes)],o)}return[e]},ie=(e,t,n,r,o,{element:s,setupChildren:i},a=null)=>{const l=`${r}-${o.slice(0,8)}`;let c=f(ne,e.domEl,()=>({}));c[r]&&((e,t)=>{const n=`lv-src-start:${t}`,r=`lv-src-end:${t}`;let o=!1;const s=[],i=document.createTreeWalker(e.parentElement||e,NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,null,!1);for(;i.nextNode();){const e=i.currentNode;if(e.nodeType===Node.COMMENT_NODE){if(e.textContent===n){o=!0,s.push(e);continue}if(e.textContent===r){s.push(e);break}}o&&s.push(e)}s.forEach(e=>e.remove()),s.length})(e.domEl,`${r}-${c[r].slice(0,8)}`),c[r]=o;const u=e=>{a&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{const t=a.startsWith("#")?a.slice(1):a,n=e.getElementById?e.getElementById(t):e.querySelector(`#${t}`);n&&(n.style.scrollMarginTop="calc(var(--site-nav-height, 0px) + 2rem)",n.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))})})};"shadow"===r?(e.domEl.shadowRoot||e.domEl.attachShadow({mode:"open"}),i(t,e.domEl.shadowRoot),oe(e.domEl.shadowRoot),u(e.domEl.shadowRoot)):"innerhtml"===r?(e.children=t,oe(e.domEl),u(document)):(((e,t,n,r,{element:o,setupChildren:s})=>{const i="outerhtml"===n,a="beforebegin"===n||"afterend"===n||i?t.parentElement:t;if(!a)return console.warn(`LightviewX: No parent for ${n}`);const l=document.createDocumentFragment();l.appendChild(re(r,!1)),e.forEach(e=>{var t,n,r;if("string"==typeof e)l.appendChild(document.createTextNode(e));else if(e.domEl)l.appendChild(e.domEl);else if(e instanceof Node)l.appendChild(e);else{const s=(null==(r=null==(t=globalThis.Lightview)?void 0:(n=t.hooks).processChild)?void 0:r.call(n,e))||e;if(s.tag){const e=o(s.tag,s.attributes||{},s.children||[]);(null==e?void 0:e.domEl)&&l.appendChild(e.domEl)}}}),l.appendChild(re(r,!0)),i?a.replaceChild(l,t):"beforebegin"===n?a.insertBefore(l,t):"afterend"===n?a.insertBefore(l,t.nextSibling):"afterbegin"===n?t.insertBefore(l,t.firstChild):"beforeend"===n&&t.appendChild(l),oe(a)})(t,e.domEl,r,l,{element:s,setupChildren:i}),u(document))},ae=async(e,t,n,{element:r,setupChildren:o})=>{if(H.includes(n))return;let s=[],i="",a=null;if("string"==typeof(l=t)&&!U(l)&&/^(https?:|\.|\/|[\w])|(\.(html|json|[vo]dom|cdomc?))$/i.test(l)){t.includes("#")&&([t,a]=t.split("#"));const n=await(async e=>{var t;try{const n=globalThis.Lightview;if((null==(t=null==n?void 0:n.hooks)?void 0:t.validateUrl)&&!n.hooks.validateUrl(e))return console.warn(`[LightviewX] Fetch blocked by validateUrl hook: ${e}`),null;const r=new URL(e,document.baseURI),o=await fetch(r);if(!o.ok)return null;const s=r.pathname.split(".").pop().toLowerCase(),i="vdom"===s||"odom"===s||"cdom"===s,a="html"===s,l="cdom"===s||"cdomc"===s,c=i?await o.json():await o.text();return{content:c,isJson:i,isHtml:a,isCdom:l,ext:s,raw:i?JSON.stringify(c):c}}catch(n){return null}})(t);n&&(s=se(n.content,n.isJson,n.isHtml,e,r,n.isCdom,n.ext),i=n.raw)}var l;if(!s.length){const e=((e,t)=>{try{const n=document.querySelectorAll(e);return n.length?{elements:te(Array.from(n),t),raw:Array.from(n).map(e=>e.outerHTML||e.textContent).join("")}:null}catch(n){return null}})(t,r);e&&(s=e.elements,i=e.raw)}if(!s.length)return;const c=(e.domEl.getAttribute("location")||"innerhtml").toLowerCase(),u=(e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t.toString(36)})(i);if(f(ne,e.domEl,()=>({}))[c]!==u)ie(e,s,0,c,u,{element:r,setupChildren:o},a);else if(a){const t="shadow"===c?e.domEl.shadowRoot:document;t&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{var e;const n=a.startsWith("#")?a.slice(1):a,r=t.getElementById?t.getElementById(n):null==(e=t.querySelector)?void 0:e.call(t,`#${n}`);r&&(r.style.scrollMarginTop="calc(var(--site-nav-height, 0px) + 2rem)",r.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))})})}},le=["beforebegin","afterbegin","beforeend","afterend","innerhtml","outerhtml","shadow"],ce=(e,{domToElement:t,wrapDomElement:n})=>{var r;const o=e.target.closest("[href]");if(!o)return;const s=o.tagName.toLowerCase();if(q.includes(s))return;e.preventDefault();const i=o.getAttribute("href"),a=globalThis.Lightview;if(i&&(U(i)||(null==(r=null==a?void 0:a.hooks)?void 0:r.validateUrl)&&!a.hooks.validateUrl(i)))return void console.warn(`[LightviewX] Navigation or fetch blocked by security policy: ${i}`);const l=o.getAttribute("target");if(!l){let e=t.get(o);if(!e){const t={};for(let e of o.attributes)t[e.name]=e.value;e=n(o,s,t)}const r={...e.attributes,src:i};return void(e.attributes=r)}if(l.startsWith("_")){switch(l){case"_self":globalThis.location.href=i;break;case"_parent":globalThis.parent.location.href=i;break;case"_top":globalThis.top.location.href=i;break;default:globalThis.open(i,l)}return}const{selector:c,location:u}=(e=>{for(const t of le){const n=":"+t;if(e.toLowerCase().endsWith(n))return{selector:e.slice(0,-n.length),location:t}}return{selector:e,location:null}})(l);try{document.querySelectorAll(c).forEach(e=>{let r=t.get(e);if(!r){const t={};for(let n of e.attributes)t[n.name]=n.value;r=n(e,e.tagName.toLowerCase(),t)}const o={...r.attributes,src:i};u&&(o.location=u),r.attributes=o})}catch(d){console.warn("Invalid target selector:",c,d)}},ue=new WeakMap,de="__lv_passed",he="__lv_resume",fe=["click","dblclick","mousedown","mouseup","contextmenu","submit","reset","change","input","invalid","keydown","keyup","keypress","touchstart","touchend"],pe=["focus","blur"],me=(e,t)=>{let n=ue.get(e);n||(n=new Map,ue.set(e,n));let r=n.get(t);return r||(r={},n.set(t,r)),r},ge=function(e){const t=arguments[arguments.length-1];if(null==t?void 0:t[he])return!0;const n=`throttle-${(null==t?void 0:t.type)||"all"}-${e}`,r=me(this,n),o=Date.now();return o-(r.last||0)>=e&&(r.last=o,!0)},ye=function(e){const t=arguments[arguments.length-1],n=`debounce-${(null==t?void 0:t.type)||"all"}-${e}`,r=me(this,n);return r.timer&&clearTimeout(r.timer),(null==t?void 0:t[he])&&r.passed?(r.passed=!1,!0):(r.timer=setTimeout(()=>{r.passed=!0;const e=new t.constructor(t.type,t);e[he]=!0,this.dispatchEvent(e)},e),!1)},ve=async e=>{var t,n;if(e[de])return;const r=null==(n=(t=e.target).closest)?void 0:n.call(t,"[lv-before]");if(!r)return;const{events:o,exclusions:s,calls:i}=(e=>{const t=[];let n="",r=0,o=null;for(let c=0;c<e.length;c++){const s=e[c];o?(n+=s,s===o&&"\\"!==e[c-1]&&(o=null)):"'"===s||'"'===s?(o=s,n+=s):"("===s?(r++,n+=s):")"===s?(r--,n+=s):/\s/.test(s)&&0===r?(n&&t.push(n),n=""):n+=s}n&&t.push(n);const s=[],i=[],a=[];let l=0;for(;l<t.length;){const e=t[l];if(!e||e.includes("("))break;e.startsWith("!")?i.push(e.slice(1)):s.push(e),l++}for(;l<t.length;)t[l]&&a.push(t[l]),l++;return{events:s,exclusions:i,calls:a}})(r.getAttribute("lv-before")),a=s.includes(e.type),l=o.includes("*")||o.includes(e.type);if(a||!l)return;e.stopImmediatePropagation(),e.preventDefault();for(const d of i)try{const t=d.match(/^([\w\.]+)\((.*)\)$/);if(!t)continue;const n=t[1],o=t[2],s=globalThis.Lightview,i=globalThis.LightviewX;let a=n.split(".").reduce((e,t)=>null==e?void 0:e[t],globalThis);if(a||"throttle"!==n||(a=ge),a||"debounce"!==n||(a=ye),!a&&i&&i[n]&&(a=i[n]),"function"!=typeof a){console.warn(`LightviewX: lv-before function '${n}' not found`);continue}const l=new Function("event","state","signal",`return [${o}]`).call(r,e,(null==s?void 0:s.state)||{},(null==s?void 0:s.signal)||{});l.push(e);let c=a.apply(r,l);if(c instanceof Promise&&(c=await c),!1===c||null==c)return}catch(u){return void console.error(`LightviewX: Error executing lv-before gate '${d}':`,u)}const c=new e.constructor(e.type,e);c[de]=!0,r.dispatchEvent(c)},be=(e,t)=>{if(e.nodeType!==Node.ELEMENT_NODE)return;const n=e.tagName.toLowerCase();if((e=>H.includes(e)||e.startsWith("lv-"))(n))return;const r=e.getAttribute("src");if(!r)return;let o=t.internals.domToElement.get(e);if(!o){const r={};for(let t of e.attributes)r[t.name]=t.value;o=t.internals.wrapDomElement(e,n,r,[])}ae(o,r,n,{element:t.element,setupChildren:t.internals.setupChildren})},we=new WeakSet,Ee=(e,t)=>{if(!e||!t)return;const n=(e,n,r=!1,o=null)=>{if(we.has(e)&&!r)return;r||we.add(e);const s=ee(n);t.effect(()=>{try{const n=s(t.state,t.signal);r?null==n||!1===n?e.removeAttribute(o):e.setAttribute(o,n):e.textContent=void 0!==n?n:""}catch(n){}})},r=document.evaluate(".//text()[contains(., '${')]",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let s=0;s<r.snapshotLength;s++){const e=r.snapshotItem(s);e.parentElement&&e.parentElement.closest("SCRIPT, STYLE, CODE, PRE, TEMPLATE, NOSCRIPT")||n(e,e.textContent)}const o=document.evaluate(".//*[@*[contains(., '${')]]",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let s=0;s<o.snapshotLength;s++){const e=o.snapshotItem(s);["SCRIPT","STYLE","CODE","PRE","TEMPLATE","NOSCRIPT"].includes(e.tagName)||Array.from(e.attributes).forEach(t=>{t.value.includes("${")&&n(e,t.value,!0,t.name)})}e.nodeType!==Node.ELEMENT_NODE||["SCRIPT","STYLE","CODE","PRE","TEMPLATE","NOSCRIPT"].includes(e.tagName)||Array.from(e.attributes).forEach(t=>{t.value.includes("${")&&n(e,t.value,!0,t.name)})},Se=(e,t,n)=>{if(e.nodeType!==Node.ELEMENT_NODE&&e.nodeType!==Node.TEXT_NODE||n.push(e),e.nodeType!==Node.ELEMENT_NODE)return;t.push(e);const r="[src]:not("+H.join("):not(")+")",o=e.querySelectorAll(r);for(const s of o)s.tagName.toLowerCase().startsWith("lv-")||t.push(s)},Ae=e=>{const t=new MutationObserver(t=>{const{nodesToProcess:n,nodesToActivate:r}=(e=>{const t=[],n=[];for(const r of e)"childList"===r.type?r.addedNodes.forEach(e=>Se(e,t,n)):"attributes"===r.type&&"src"===r.attributeName&&t.push(r.target);return{nodesToProcess:t,nodesToActivate:n}})(t);(n.length>0||r.length>0)&&requestAnimationFrame(()=>{r.forEach(t=>Ee(t,e)),n.forEach(t=>be(t,e))})});return t.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["src"]}),t};if("undefined"!=typeof window&&globalThis.Lightview){const e=globalThis.Lightview;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>Ae(e)):Ae(e);const t=()=>{requestAnimationFrame(()=>{Ee(document.body,e);const t="[src]:not("+H.join("):not(")+")";document.querySelectorAll(t).forEach(t=>{t.tagName.toLowerCase().startsWith("lv-")||be(t,e)})})};document.body?t():document.addEventListener("DOMContentLoaded",t),e.hooks.onNonStandardHref=t=>{ce(t,{domToElement:e.internals.domToElement,wrapDomElement:e.internals.wrapDomElement})},fe.forEach(e=>window.addEventListener(e,ve,!0)),pe.forEach(e=>window.addEventListener(e,ve,!0)),e.hooks.processChild=t=>{if(!t)return t;if("object"!=typeof t||Array.isArray(t)||t.tag||t.domEl||(t=z(t)),"string"==typeof t&&t.startsWith("$")&&isNaN(parseInt(t[1]))){const e=globalThis.LightviewCDOM;if(e)return e.parseExpression(t)}if("string"==typeof t&&(t.trim().startsWith("{")||t.trim().startsWith("[")))try{const e=new Function("return ("+t+")")();if("object"==typeof e&&null!==e)return Array.isArray(e)||e.tag||e.domEl?e:z(e)}catch(n){}return((e,t)=>{if("string"==typeof e&&e.includes("${")){const n=ee(e);return()=>n(t.state,t.signal)}return e})(t,{state:y,signal:e.signal})}}const Te={state:y,themeSignal:G,setTheme:Z,registerStyleSheet:J,registerThemeSheet:async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch theme CSS: ${t.status}`);const n=await t.text(),r=new CSSStyleSheet;r.replaceSync(n),V.themeStyleSheet=r}catch(t){console.error(`LightviewX: Failed to register theme stylesheet '${e}':`,t)}},throttle:ge,debounce:ye,initComponents:K,componentConfig:V,shouldUseShadow:e=>void 0!==e?e:V.shadowDefault,getAdoptedStyleSheets:Q,preloadComponentCSS:async e=>{V.componentStyleSheets.has(e)||await(async e=>{if(V.componentStyleSheets.has(e))return V.componentStyleSheets.get(e);try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch component CSS: ${t.status}`);const n=await t.text(),r=new CSSStyleSheet;return r.replaceSync(n),V.componentStyleSheets.set(e,r),r}catch(t){return console.error(`LightviewX: Failed to create stylesheet for ${e}:`,t),null}})(e)},createCustomElement:(e,t={})=>class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}async connectedCallback(){const{cssUrl:n,styles:r}=t;this.themeWrapper=document.createElement("div"),this.themeWrapper.style.display="contents";const o=()=>{const e=document.documentElement.getAttribute("data-theme")||"light";this.themeWrapper.setAttribute("data-theme",e)};o(),this.themeObserver=new MutationObserver(o),this.themeObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),this.shadowRoot.appendChild(this.themeWrapper);const s=Q(n,r);try{const e=s.filter(e=>e instanceof CSSStyleSheet);this.shadowRoot.adoptedStyleSheets=e}catch(i){}if(!V.daisyStyleSheet){const e=document.createElement("link");e.rel="stylesheet",e.href=X,this.shadowRoot.appendChild(e)}s.forEach(e=>{if("string"==typeof e){const t=document.createElement("link");t.rel="stylesheet",t.href=e,this.shadowRoot.appendChild(t)}}),this.render=()=>{const t={};for(const e of this.attributes){const n=e.name.replace(/-([a-z])/g,e=>e[1].toUpperCase());""===e.value?t[n]=!0:t[n]=e.value}t.useShadow=!1;const n=globalThis.Lightview.tags.slot(),r=e(t,n);globalThis.Lightview.internals.setupChildren([r],this.themeWrapper)},"undefined"!=typeof MutationObserver&&"undefined"!=typeof HTMLElement&&(this.attrObserver=new MutationObserver(e=>{this.render()}),this.attrObserver.observe(this,{attributes:!0})),this.render()}disconnectedCallback(){this.themeObserver&&this.themeObserver.disconnect(),this.attrObserver&&this.attrObserver.disconnect()}},customElementWrapper:(e,t={})=>{const{attributeMap:n={},childElements:r={}}=t;return class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/daisyui@5.5.14/daisyui.min.css",this.shadowRoot.appendChild(e);const t=document.createElement("div");t.setAttribute("data-theme",document.documentElement.getAttribute("data-theme")||"light"),t.style.display="contents",this.shadowRoot.appendChild(t),this.themeWrapper=t,this.themeObserver=new MutationObserver(()=>{const e=document.documentElement.getAttribute("data-theme")||"light";this.themeWrapper.setAttribute("data-theme",e)}),this.themeObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),this.render();const o=Object.keys(n);o.length>0&&(this.attrObserver=new MutationObserver(()=>this.render()),this.attrObserver.observe(this,{attributes:!0,attributeFilter:o})),Object.keys(r).length>0&&(this.childObserver=new MutationObserver(()=>this.render()),this.childObserver.observe(this,{childList:!0,subtree:!0,attributes:!0}))}disconnectedCallback(){this.themeObserver&&this.themeObserver.disconnect(),this.attrObserver&&this.attrObserver.disconnect(),this.childObserver&&this.childObserver.disconnect()}parseChildrenToVDOM(){return Array.from(this.children).map(e=>{const t=e.tagName.toLowerCase(),n=r[t];if(!n)return null;const{component:o,attributeMap:s={},innerHTML:i=!1}=n,a={};return Object.entries(s).forEach(([t,n])=>{const r=e.getAttribute(t);null!==r&&(n===Boolean?a[t]="true"===r||""===r:a[t]=n===Number?Number(r):r)}),e.onclick&&(a.onclick=e.onclick.bind(e)),{tag:o,attributes:a,children:i?[e.innerHTML]:[e.textContent]}}).filter(Boolean)}render(){var t,o;const s={useShadow:!1};Object.entries(n).forEach(([e,t])=>{const n=this.getAttribute(e);null!==n&&(t===Boolean?s[e]="true"===n||""===n:s[e]=t===Number?Number(n):n)});const i=this.parseChildrenToVDOM(),a=Object.keys(r).length>0?i:[{tag:globalThis.Lightview.tags.slot}],l=e(s,...a);(null==(o=null==(t=globalThis.Lightview)?void 0:t.internals)?void 0:o.setupChildren)&&this.themeWrapper&&(this.themeWrapper.innerHTML="",globalThis.Lightview.internals.setupChildren([l],this.themeWrapper))}static get observedAttributes(){return Object.keys(n)}attributeChangedCallback(){this.render()}}},internals:{handleSrcAttribute:ae,parseElements:se}};if("undefined"!=typeof module&&module.exports&&(module.exports=Te),"undefined"!=typeof window&&(globalThis.LightviewX=Te),"undefined"!=typeof window){try{const e=Y();e&&Z(e)}catch(On){}"undefined"!=typeof window&&globalThis.Lightview&&(globalThis.Lightview.hooks.validateUrl||(globalThis.Lightview.hooks.validateUrl=B))}"undefined"!=typeof globalThis&&globalThis.Lightview&&(globalThis.Lightview.hooks.validateUrl||(globalThis.Lightview.hooks.validateUrl=B));const Le=new Map,Ce=new Map,Ne=(e,t,n={})=>{Le.set(e,t),n&&Ce.set(e,n)},Oe=()=>globalThis.Lightview||null,Me=()=>{var e;return(null==(e=Oe())?void 0:e.registry)||null};class ke{constructor(e,t){this.parent=e,this.key=t,this.isBindingTarget=!0}get value(){return this.parent[this.key]}set value(e){this.parent[this.key]=e}get __parent__(){return this.parent}}const _e=e=>e&&"function"==typeof e&&"value"in e?e.value:!e||"object"!=typeof e||globalThis.Node&&e instanceof globalThis.Node||!("value"in e)?e:e.value,We=(e,t)=>{let n=e;for(const r of t){if(!r)continue;if(n=_e(n),null==n)return;n=n[r.startsWith("[")?r.slice(1,-1):r]}return _e(n)},xe=(e,t)=>{let n=e;for(let r=0;r<t.length;r++){const e=t[r];if(!e)continue;const o=e.startsWith("[")?e.slice(1,-1):e,s=_e(n);if(null==s)return;if(r===t.length-1)return new ke(s,o);n=s[o]}return n},$e=(e,t)=>{if("string"!=typeof e)return e;const n=Me();if("."===e)return _e(t);if(e.startsWith("$/")){const[t,...r]=e.slice(2).split("/"),o=null==n?void 0:n.get(t);if(!o)return;return We(o,r)}if(e.startsWith("./"))return We(t,e.slice(2).split("/"));if(e.startsWith("../"))return We(null==t?void 0:t.__parent__,e.slice(3).split("/"));if(e.includes("/")||e.includes("."))return We(t,e.split(/[\/.]/));const r=_e(t);return r&&"object"==typeof r&&(e in r||void 0!==r[e])?We(r,[e]):e},je=(e,t)=>{if("string"!=typeof e)return e;const n=Me();if("."===e)return t;if(e.startsWith("$/")){const t=e.slice(2).split(/[\/.]/),r=t.shift(),o=null==n?void 0:n.get(r);if(!o)return;return xe(o,t)}if(e.startsWith("./"))return xe(t,e.slice(2).split(/[\/.]/));if(e.startsWith("../"))return xe(null==t?void 0:t.__parent__,e.slice(3).split(/[\/.]/));if(e.includes("/")||e.includes("."))return xe(t,e.split(/[\/.]/));const r=_e(t);return r&&"object"==typeof r&&/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(e)?new ke(r,e):e};class De{constructor(e){this.fn=e,this.isLazy=!0}resolve(e){return this.fn(e)}}const Ie=(e,t,n=!1)=>{if(e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"'))return{value:e.slice(1,-1),isLiteral:!0};if(""!==e&&!isNaN(Number(e)))return{value:Number(e),isLiteral:!0};if("true"===e)return{value:!0,isLiteral:!0};if("false"===e)return{value:!1,isLiteral:!0};if("null"===e)return{value:null,isLiteral:!0};if("_"===e||e.startsWith("_/")||e.startsWith("_."))return{value:new De(t=>{if("_"===e)return t;const n=(e.startsWith("_."),e.slice(2));return $e(n,t)}),isLazy:!0};if("$event"===e||e.startsWith("$event/")||e.startsWith("$event."))return{value:new De(t=>{if("$event"===e)return t;const n=(e.startsWith("$event."),e.slice(7));return $e(n,t)}),isLazy:!0};if(e.includes("(")){let r=e;e.startsWith("/")?r="$"+e:!n||e.startsWith("$")||e.startsWith("./")||(r=`$/${e}`);const o=Re(r,t);return o instanceof De?{value:o,isLazy:!0}:{value:o,isSignal:!1}}const r=e.endsWith("..."),o=r?e.slice(0,-3):e;let s;if(s=o.startsWith("/")?"$"+o:o.startsWith("$")||o.startsWith("./")||o.startsWith("../")?o:n?`$/${o}`:`./${o}`,r){const e=s.split("/"),n=e.pop(),r=e.join("/"),o=r?$e(r,t):t,i=_e(o);if(Array.isArray(i)){return{value:i.map(e=>{const t=_e(e);return t&&t[n]}),isExplosion:!0}}if(i&&"object"==typeof i){const e=i[n];return{value:_e(e),isExplosion:!0}}return{value:void 0,isExplosion:!0}}return{value:je(s,t),isExplosion:!1}},Re=(e,t)=>{var n;if("string"!=typeof e)return e;const r=e.indexOf("(");if(-1!==r&&e.endsWith(")")){const o=e.slice(0,r).trim(),s=e.slice(r+1,-1),i=o.split("/");let a=i.pop().replace(/^\$/,"");""===a&&(i.length>0||"/"===o)&&(a="/");const l=i.join("/"),c=e.startsWith("$/")||e.startsWith("$");let u=t;l&&"$"!==l&&(u=je(l,t));const d=Le.get(a);if(!d)return null==(n=globalThis.console)||n.warn(`LightviewCDOM: Helper "${a}" not found.`),e;const h=Ce.get(a)||{},f=[];let p="",m=0,g=null;for(let e=0;e<s.length;e++){const t=s[e];if(t===g)g=null;else if(g||"'"!==t&&'"'!==t)if(g||"("!==t)if(g||")"!==t){if(!g&&","===t&&0===m){f.push(p.trim()),p="";continue}}else m--;else m++;else g=t;p+=t}p&&f.push(p.trim());const y=[];let v=!1;for(let e=0;e<f.length;e++){const t=f[e],n=Ie(t,u,c&&("$"===l||!l));n.isLazy&&(v=!0);const r=!(h.pathAware&&0===e);let o=r?_e(n.value):n.value;n.isExplosion&&Array.isArray(o)?y.push(...o.map(e=>r?_e(e):e)):y.push(o)}if(v)return new De(e=>{const t=y.map((t,n)=>{const r=!(h.pathAware&&0===n),o=t instanceof De?t.resolve(e):t;return r?_e(o):o});return d(...t)});const b=d(...y);return _e(b)}return _e($e(e,t))},Pe=(e,t)=>{const n=Oe();return n&&"string"==typeof e?n.computed(()=>Re(e,t)):e},Fe=(...e)=>e.reduce((e,t)=>Number(e)+Number(t),0),He=(e,t)=>Number(e)-Number(t),qe=(...e)=>e.reduce((e,t)=>Number(e)*Number(t),1),Ue=(e,t)=>Number(e)/Number(t),Be=(e,t=0)=>Number(Math.round(e+"e"+t)+"e-"+t),ze=e=>Math.ceil(e),Xe=e=>Math.floor(e),Ve=e=>Math.abs(e),Je=(e,t)=>e%t,Ye=(e,t)=>Math.pow(e,t),Ge=e=>Math.sqrt(e),Ze=(e,t,n)=>e?t:n,Ke=(...e)=>e.every(Boolean),Qe=(...e)=>e.some(Boolean),et=e=>!e,tt=(e,t)=>e===t,nt=(e,t)=>e!==t,rt=(...e)=>{const t=e[e.length-1];return e.slice(0,-1).join(t)},ot=(...e)=>e.join(""),st=e=>String(e).toUpperCase(),it=e=>String(e).toLowerCase(),at=e=>String(e).trim(),lt=e=>String(e).length,ct=(e,t,n)=>String(e).replace(t,n),ut=(e,t)=>String(e).split(t),dt=e=>{const t=String(e);return t.charAt(0).toUpperCase()+t.slice(1)},ht=e=>String(e).toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),ft=(e,t)=>String(e).includes(t),pt=(e,t)=>String(e).startsWith(t),mt=(e,t)=>String(e).endsWith(t),gt=(e,t)=>null!=e?e:t,yt=(...e)=>e.length,vt=(e,t)=>Array.isArray(e)?"function"==typeof t&&t.isLazy?e.filter(e=>t.resolve(e)):e.filter(e=>!!e):[],bt=(e,t)=>Array.isArray(e)?"string"==typeof t?e.map(e=>e&&"object"==typeof e?e[t]:e):t&&t.isLazy?e.map(e=>t.resolve(e)):e:[],wt=(e,t)=>{if(Array.isArray(e))return t&&t.isLazy?e.find(e=>t.resolve(e)):e.find(e=>!!e)},Et=e=>Array.isArray(e)?[...new Set(e)]:[],St=(e,t="asc")=>{if(!Array.isArray(e))return[];const n=[...e];return n.sort((e,n)=>e<n?"asc"===t?-1:1:e>n?"asc"===t?1:-1:0),n},At=e=>Array.isArray(e)?[...e].reverse():[],Tt=e=>Array.isArray(e)?e[0]:void 0,Lt=e=>Array.isArray(e)?e[e.length-1]:void 0,Ct=(e,t,n)=>Array.isArray(e)?e.slice(t,n):[],Nt=e=>Array.isArray(e)?e.flat(1/0):[],Ot=(e,t=",")=>Array.isArray(e)?e.join(String(t)):"",Mt=e=>Array.isArray(e)?e.length:e?String(e).length:0,kt=(e,t)=>e>t,_t=(e,t)=>e<t,Wt=(e,t)=>e>=t,xt=(e,t)=>e<=t,$t=(e,t)=>e!==t,jt=(e,t,n)=>e>=t&&e<=n,Dt=(e,t)=>Array.isArray(e)&&e.includes(t),It=(e,t)=>{if(!Array.isArray(e))return 0;return(t&&t.isLazy?e.filter(e=>t.resolve(e)):e).reduce((e,t)=>e+(Number(t)||0),0)},Rt=(e,t)=>Array.isArray(e)?t&&t.isLazy?e.filter(e=>t.resolve(e)).length:e.filter(e=>!!e).length:0,Pt=(e,t)=>{if(!Array.isArray(e))return 0;const n=t&&t.isLazy?e.filter(e=>t.resolve(e)):e;return 0===n.length?0:n.reduce((e,t)=>e+(Number(t)||0),0)/n.length},Ft=()=>(new Date).getTime(),Ht=()=>{const e=new Date;return e.setHours(0,0,0,0),e.getTime()},qt=e=>new Date(e).getTime(),Ut=(e,t)=>{const n=new Date(e);if(isNaN(n.getTime()))return"";const r={year:"numeric",month:"2-digit",day:"2-digit"};return"long"===t&&(r.month="long"),n.toLocaleDateString(void 0,r)},Bt=e=>new Date(e).getFullYear(),zt=e=>new Date(e).getMonth()+1,Xt=e=>new Date(e).getDate(),Vt=e=>new Date(e).getDay(),Jt=(e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+Number(t)),n.getTime()},Yt=(e,t,n="days")=>{const r=Math.abs(new Date(e)-new Date(t));return"seconds"===n?r/1e3:"minutes"===n?r/6e4:"hours"===n?r/36e5:r/864e5},Gt=(e,t=2)=>Number(e).toFixed(t),Zt=(e,t="$",n=2)=>t+Number(e).toFixed(n).replace(/\B(?=(\d{3})+(?!\d))/g,","),Kt=(e,t=0)=>(100*Number(e)).toFixed(t)+"%",Qt=e=>String(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),en=(e,t,n)=>{if(!Array.isArray(t))return;const r=t.indexOf(e);return-1!==r&&Array.isArray(n)?n[r]:void 0},tn=(e,t,n)=>{if(!Array.isArray(t))return;const r=t.find(t=>Array.isArray(t)&&t[0]===e);return r?r[n-1]:void 0},nn=(e,t)=>Array.isArray(e)?e[t]:void 0,rn=(e,t)=>Array.isArray(t)?t.indexOf(e):-1,on=(...e)=>e.reduce((e,t)=>e+(Number(t)||0),0),sn=(...e)=>0===e.length?0:on(...e)/e.length,an=(...e)=>Math.min(...e),ln=(...e)=>Math.max(...e),cn=(...e)=>{if(0===e.length)return 0;const t=[...e].sort((e,t)=>e-t),n=Math.floor(t.length/2);return t.length%2!=0?t[n]:(t[n-1]+t[n])/2},un=(...e)=>{if(0===e.length)return 0;const t=sn(...e),n=e.map(e=>Math.pow(e-t,2));return Math.sqrt(sn(...n))},dn=(...e)=>{if(0===e.length)return 0;const t=sn(...e),n=e.map(e=>Math.pow(e-t,2));return sn(...n)},hn=(e,t)=>(e&&"object"==typeof e&&"value"in e||e&&"function"==typeof e&&"value"in e?e.value=t:e&&"object"==typeof e&&t&&"object"==typeof t&&Object.assign(e,t),t),fn=(e,t=1)=>{const n=e&&"object"==typeof e&&"value"in e?e.value:0,r=Number(n)+Number(t);return hn(e,r)},pn=(e,t=1)=>{const n=e&&"object"==typeof e&&"value"in e?e.value:0,r=Number(n)-Number(t);return hn(e,r)},mn=e=>{const t=!(!e||"object"!=typeof e||!("value"in e))&&e.value;return hn(e,!t)},gn=(e,t)=>{const n=e&&"object"==typeof e&&"value"in e?e.value:[];if(Array.isArray(n)){const r=[...n,t];return hn(e,r)}return n},yn=e=>{const t=e&&"object"==typeof e&&"value"in e?e.value:[];if(Array.isArray(t)&&t.length>0){const n=t.slice(0,-1);hn(e,n)}return t},vn=(e,t)=>{const n={...e&&"object"==typeof e&&"value"in e?e.value:{},...t};return hn(e,n)},bn=e=>{const t=e&&"object"==typeof e&&"value"in e?e.value:null;return Array.isArray(t)?hn(e,[]):hn(e,"object"==typeof t&&null!==t?{}:null)};var wn;(wn=Ne)("+",Fe),wn("add",Fe),wn("-",He),wn("sub",He),wn("*",qe),wn("mul",qe),wn("/",Ue),wn("div",Ue),wn("round",Be),wn("ceil",ze),wn("floor",Xe),wn("abs",Ve),wn("mod",Je),wn("pow",Ye),wn("sqrt",Ge),(e=>{e("if",Ze),e("and",Ke),e("&&",Ke),e("or",Qe),e("||",Qe),e("not",et),e("!",et),e("eq",tt),e("==",tt),e("===",tt),e("neq",nt)})(Ne),(e=>{e("join",rt),e("concat",ot),e("upper",st),e("lower",it),e("trim",at),e("len",lt),e("replace",ct),e("split",ut),e("capitalize",dt),e("titleCase",ht),e("contains",ft),e("startsWith",pt),e("endsWith",mt),e("default",gt)})(Ne),(e=>{e("count",yt),e("filter",vt),e("map",bt),e("find",wt),e("unique",Et),e("sort",St),e("reverse",At),e("first",Tt),e("last",Lt),e("slice",Ct),e("flatten",Nt),e("join",Ot),e("len",Mt),e("length",Mt)})(Ne),(e=>{e("gt",kt),e(">",kt),e("lt",_t),e("<",_t),e("gte",Wt),e(">=",Wt),e("lte",xt),e("<=",xt),e("neq",$t),e("!=",$t),e("between",jt),e("in",Dt)})(Ne),(e=>{e("sumIf",It),e("countIf",Rt),e("avgIf",Pt)})(Ne),(e=>{e("now",Ft),e("today",Ht),e("date",qt),e("formatDate",Ut),e("year",Bt),e("month",zt),e("day",Xt),e("weekday",Vt),e("addDays",Jt),e("dateDiff",Yt)})(Ne),(e=>{e("number",Gt),e("currency",Zt),e("percent",Kt),e("thousands",Qt)})(Ne),(e=>{e("lookup",en),e("vlookup",tn),e("index",nn),e("match",rn)})(Ne),(e=>{e("sum",on),e("avg",sn),e("min",an),e("max",ln),e("median",cn),e("stdev",un),e("var",dn)})(Ne),(e=>{const t={pathAware:!0};e("set",hn,t),e("increment",fn,t),e("++",fn,t),e("decrement",pn,t),e("--",pn,t),e("toggle",mn,t),e("!!",mn,t),e("push",gn,t),e("pop",yn,t),e("assign",vn,t),e("clear",bn,t)})((e,t)=>Ne(e,t,{pathAware:!0}));const En=new WeakMap,Sn=(e,t=null)=>{const n=[];let o=e;const s=globalThis.ShadowRoot;for(;o;){const e=En.get(o);e&&n.unshift(e),o=o.parentElement||(s&&o.parentNode instanceof s?o.parentNode.host:null)}const i=r();return new Proxy({},{get(e,r,o){var s;if("$event"===r||"event"===r)return t;if("__parent__"===r)return;for(let t=n.length-1;t>=0;t--){const e=n[t];if(r in e)return e[r]}if(i&&i.has(r))return i.get(r);const a=null==(s=globalThis.Lightview)?void 0:s.state;return a&&r in a?a[r]:void 0},set(e,t,r,o){var s;for(let a=n.length-1;a>=0;a--){const e=n[a];if(t in e)return e[t]=r,!0}if(n.length>0)return n[n.length-1][t]=r,!0;const i=null==(s=globalThis.Lightview)?void 0:s.state;return!!i&&(i[t]=r,!0)},has(e,r){var o;if("$event"===r||"event"===r)return!!t;for(const t of n)if(r in t)return!0;const s=null==(o=globalThis.Lightview)?void 0:o.state;return!(!s||!(r in s))},ownKeys(e){var r;const o=new Set;t&&(o.add("$event"),o.add("event"));for(const t of n)for(const e in t)o.add(e);const s=null==(r=globalThis.Lightview)?void 0:r.state;if(s)for(const t in s)o.add(t);return Array.from(o)},getOwnPropertyDescriptor:(e,t)=>({enumerable:!0,configurable:!0})})},An=e=>{var t;const n=e.getAttribute("cdom-state");if(n&&!En.has(e))try{const t=JSON.parse(n),r=y(t);En.set(e,r)}catch(On){null==(t=globalThis.console)||t.error("LightviewCDOM: Failed to parse cdom-state",On)}},Tn=e=>{const t=e.getAttribute("cdom-bind");if(!t)return;const r=e.type||"",o=e.tagName.toLowerCase();let s="value",i="input";"checkbox"===r||"radio"===r?(s="checked",i="change"):"select"===o&&(i="change");const a=Sn(e);let l=je(t,a);if(l&&l.isBindingTarget&&void 0===l.value){const n=e[s];void 0!==n&&""!==n&&(hn(a,{[l.key]:n}),l=je(t,a))}n(()=>{const t=_e(l);e[s]!==t&&(e[s]=void 0===t?"":t)}),e.addEventListener(i,()=>{const n=e[s];l&&l.isBindingTarget?l.value=n:hn(a,{[t]:n})})},Ln=e=>{Array.from(e.attributes).forEach(t=>{if(t.name.startsWith("cdom-on:")){const n=t.name.slice(8),r=t.value;e.addEventListener(n,t=>{const n=Sn(e,t),o=Re(r,n);o&&"object"==typeof o&&o.isLazy&&"function"==typeof o.resolve&&o.resolve(t)})}})},Cn=(e,t=null)=>{if(!e)return e;if("string"==typeof e&&e.startsWith("$"))return Pe(e,t);if(Array.isArray(e))return e.map(e=>Cn(e,t));if(e instanceof String)return e.toString();if("object"==typeof e&&null!==e){t&&!("__parent__"in e)&&Object.defineProperty(e,"__parent__",{value:t,enumerable:!1,writable:!0,configurable:!0});for(const t in e)e[t]=Cn(e[t],e);return e}return e},Nn={registerHelper:Ne,parseExpression:Pe,resolvePath:$e,resolvePathAsContext:je,resolveExpression:Re,parseCDOMC:e=>{let t=0;const n=e.length,r=()=>{for(;t<n;){const r=e[t];if(!/\s/.test(r)){if("/"===r){const r=e[t+1];if("/"===r){for(t+=2;t<n&&"\n"!==e[t]&&"\r"!==e[t];)t++;continue}if("*"===r){for(t+=2;t<n;){if("*"===e[t]&&"/"===e[t+1]){t+=2;break}t++}continue}}break}t++}},o=()=>{const r=e[t++];let o="";for(;t<n;){const n=e[t++];if(n===r)return new String(o);if("\\"===n){const n=e[t++];o+="n"===n?"\n":"t"===n?"\t":'"'===n?'"':"'"===n?"'":"\\"===n?"\\":n}else o+=n}throw new Error("Unterminated string")},s=()=>{const r=t;let o=0;for(;t<n;){const n=e[t];if(o>0)")"===n?o--:"("===n&&o++,t++;else{if(/[\s:,{}\[\]"'`()]/.test(n)){if("("===n){o++,t++;continue}break}t++}}const s=e.slice(r,t);return"true"===s||"false"!==s&&("null"===s?null:""===s.trim()||isNaN(Number(s))?s:Number(s))},i=()=>{if(r(),t>=n)return;const i=e[t];return"{"===i?a():"["===i?l():'"'===i||"'"===i?o():s()},a=()=>{t++;const a={};if(r(),t<n&&"}"===e[t])return t++,a;for(;t<n;){let n;if(r(),n='"'===e[t]||"'"===e[t]?o():s(),r(),":"!==e[t])throw new Error(`Expected ':' at position ${t}, found '${e[t]}'`);t++;const l=i();if(a[String(n)]=l,r(),"}"===e[t])return t++,a;if(","!==e[t])throw new Error(`Expected '}' or ',' at position ${t}, found '${e[t]}'`);if(t++,r(),"}"===e[t])return t++,a}},l=()=>{t++;const o=[];if(r(),t<n&&"]"===e[t])return t++,o;for(;t<n;){const n=i();if(o.push(n),r(),"]"===e[t])return t++,o;if(","!==e[t])throw new Error(`Expected ']' or ',' at position ${t}, found '${e[t]}'`);if(t++,r(),"]"===e[t])return t++,o}};r();return i()},unwrapSignal:_e,getContext:Sn,handleCDOMState:An,handleCDOMBind:Tn,handleCDOMOn:Ln,activate:(e=document.body)=>{const t=e=>{1===e.nodeType&&(e.hasAttribute("cdom-state")&&An(e),e.hasAttribute("cdom-bind")&&Tn(e),Ln(e));let n=e.firstChild;for(;n;)t(n),n=n.nextSibling};t(e)},hydrate:Cn,version:"1.0.0"};"undefined"!=typeof window&&(globalThis.LightviewCDOM=Nn),console.log("Lightview Full Bundle Loaded")}();
