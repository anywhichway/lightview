!function(){"use strict";const e=globalThis.__LIGHTVIEW_INTERNALS__||(globalThis.__LIGHTVIEW_INTERNALS__={currentEffect:null,registry:new Map,dependencyMap:new WeakMap}),t=(t,n)=>{let r="string"==typeof n?n:null==n?void 0:n.name;const o=null==n?void 0:n.storage;if(r&&o)try{const e=o.getItem(r);null!==e&&(t=JSON.parse(e))}catch(l){}let s=t;const i=new Set,a=(...e)=>{if(0===e.length)return a.value;a.value=e[0]};if(Object.defineProperty(a,"value",{get:()=>(e.currentEffect&&(i.add(e.currentEffect),e.currentEffect.dependencies.add(i)),s),set(e){if(s!==e){if(s=e,r&&o)try{o.setItem(r,JSON.stringify(s))}catch(l){}[...i].forEach(e=>e())}}}),r)if(e.registry.has(r)){if(e.registry.get(r)!==a)throw new Error(`Lightview: A signal or state with the name "${r}" is already registered.`)}else e.registry.set(r,a);return a};t.get=(n,r)=>e.registry.has(n)||void 0===r?e.registry.get(n):t(r,n);const n=()=>e.registry,r=new WeakMap,o=new WeakMap,s=new WeakMap,i=(e,t)=>Object.getOwnPropertyNames(e).filter(n=>"function"==typeof e[n]&&t(n)),a=i(Date.prototype,e=>/^(to|get|valueOf)/.test(e)),l=i(Date.prototype,e=>/^set/.test(e)),c=["map","forEach","filter","find","findIndex","some","every","reduce","reduceRight","includes","indexOf","lastIndexOf","join","slice","concat","flat","flatMap","at","entries","keys","values"],h=["push","pop","shift","unshift","splice","sort","reverse","fill","copyWithin"],u=["map","forEach","filter","find","findIndex","some","every","flatMap"],d=(e,t,n)=>{let r=e.get(t);return r||(r=n(),e.set(t,r)),r},f=(e,n,r,o)=>{if("__parent__"===n)return s.get(r);o.has(n)||o.set(n,t(Reflect.get(e,n,r)));const i=o.get(n).value;if("object"==typeof i&&null!==i){const e=g(i);return s.set(e,r),e}return i},m=(e,n,r,o,s)=>{s.has(n)||s.set(n,t(Reflect.get(e,n,o)));const i=Reflect.set(e,n,r,o),a=s.get(n);return i&&a&&(a.value=r),i},p=(e,n,r=[])=>{const i=d(o,e,()=>new Map);if(!i.has(n)){const r="function"==typeof e[n]?e[n].call(e):e[n];i.set(n,t(r))}const p=e instanceof Date,y=Array.isArray(e),v=p?a:y?c:r,b=p?l:y?h:[];return new Proxy(e,{get(e,t,r){if("__parent__"===t)return s.get(r);const o=e[t];if("function"==typeof o){const a=v.includes(t),l=b.includes(t);return function(...c){if(a){const e=i.get(n);e&&e.value}const h="function"==typeof e[n]?e[n].call(e):e[n];if(y&&u.includes(t)&&"function"==typeof c[0]){const e=c[0];c[0]=function(t,n,o){const i="object"==typeof t&&null!==t?g(t):t;return i&&"object"==typeof i&&s.set(i,r),e.call(this,i,n,o)}}const d=o.apply(e,c),f="function"==typeof e[n]?e[n].call(e):e[n];if(h!==f||l){const e=i.get(n);e&&e.value!==f&&(e.value=f)}return d}}if(t===n){const o=i.get(n);return o?o.value:Reflect.get(e,t,r)}if(y&&!isNaN(parseInt(t))){const e=i.get(n);e&&e.value}return f(e,t,r,i)},set(e,t,r,o){if(t===n){const s=Reflect.set(e,t,r,o);if(s){const e=i.get(n);e&&(e.value=r)}return s}return m(e,t,r,o,i)}})},g=(t,i)=>{if("object"!=typeof t||null===t)return t;const a="string"==typeof i?i:null==i?void 0:i.name,l=null==i?void 0:i.storage;if(a&&l)try{const e=l.getItem(a);if(e){const n=JSON.parse(e);Array.isArray(t)&&Array.isArray(n)?(t.length=0,t.push(...n)):Object.assign(t,n)}}catch(h){}let c=r.get(t);if(!c){const e=Array.isArray(t),n=t instanceof Date,i=e||n;if(!i&&(t instanceof RegExp||t instanceof Map||t instanceof Set||t instanceof WeakMap||t instanceof WeakSet))return t;c=i?p(t,e?"length":n?"getTime":null):new Proxy(t,{get:(e,t,n)=>"__parent__"===t?s.get(n):f(e,t,n,d(o,e,()=>new Map)),set:(e,t,n,r)=>m(e,t,n,r,d(o,e,()=>new Map))}),r.set(t,c)}if(a&&l&&(t=>{const n=()=>{if(n.active&&!n.running){n.dependencies.forEach(e=>e.delete(n)),n.dependencies.clear(),n.running=!0,e.currentEffect=n;try{t()}finally{e.currentEffect=null,n.running=!1}}};n.active=!0,n.running=!1,n.dependencies=new Set,n.stop=()=>{n.dependencies.forEach(e=>e.delete(n)),n.dependencies.clear(),n.active=!1},n()})(()=>{try{l.setItem(a,JSON.stringify(c))}catch(h){}}),a){const e=n();if(e.has(a)){if(e.get(a)!==c)throw new Error(`Lightview: A signal or state with the name "${a}" is already registered.`)}else e.set(a,c)}return c};g.get=(e,t)=>{const r=n();return r.has(e)||void 0===t?r.get(e):g(t,e)};const y=["img","script","iframe","video","audio","source","track","embed","input"],v=["a","area","base","link"],b=e=>{if(!e||"string"!=typeof e)return!1;const t=e.trim().toLowerCase();return t.startsWith("javascript:")||t.startsWith("vbscript:")||t.startsWith("data:text/html")||t.startsWith("data:application/javascript")},w=e=>{if(!e)return!1;if(!/^[a-z][a-z0-9+.-]*:/i.test(e))return!0;try{const t="undefined"!=typeof document?document.baseURI:globalThis.location.origin,n=new URL(e,"null"===t?void 0:t),r=globalThis.location;return n.origin===r.origin&&"null"!==n.origin||(!(!n.hostname||n.hostname!==r.hostname)||(!!(n.hostname&&r.hostname&&n.hostname.endsWith("."+r.hostname))||"file:"===r.protocol&&"file:"===n.protocol))}catch(t){return!1}},E=e=>{var t,n;if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return e.map(E);if(e.tag)return{...e,children:e.children?E(e.children):[]};if(e.domEl||!(e=>{if("object"!=typeof e||null===e||Array.isArray(e)||e.tag||e.domEl)return!1;const t=Object.keys(e);return 1===t.length&&"string"==typeof(n=t[0])&&n.length>0&&"children"!==n&&"object"==typeof e[t[0]];var n})(e))return e;const r=Object.keys(e)[0],o=e[r],s="undefined"!=typeof window||"undefined"!=typeof globalThis?globalThis.Lightview:null,i=(null==(n=null==(t=null==s?void 0:s.tags)?void 0:t._customTags)?void 0:n[r])||r,{children:a,...l}=o;return{tag:i,attributes:l,children:a?E(a):[]}},S="https://cdn.jsdelivr.net/npm/daisyui@3.9.4/dist/full.min.css",T={initialized:!1,shadowDefault:!0,daisyStyleSheet:null,themeStyleSheet:null,componentStyleSheets:new Map,customStyleSheets:new Map},C=async(e,t)=>{if(!T.customStyleSheets.has(e))try{let n=t;if(void 0===n)if(e.startsWith("#")){const t=document.querySelector(e);if(!t)throw new Error(`Style block '${e}' not found`);n=t.textContent}else{const t=await fetch(e);if(!t.ok)throw new Error(`Fetch failed: ${t.status}`);n=await t.text()}if(void 0!==n){const t=new CSSStyleSheet;t.replaceSync(n),T.customStyleSheets.set(e,t)}}catch(n){console.error(`LightviewX: Failed to register stylesheet '${e}':`,n)}},L=()=>{try{if("undefined"!=typeof localStorage)return localStorage.getItem("lightview-theme")}catch(e){return null}},O=t("undefined"!=typeof document&&document.documentElement.getAttribute("data-theme")||L()||"light"),A=e=>{if(e){"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",e),O&&O.value!==e&&(O.value=e);try{"undefined"!=typeof localStorage&&localStorage.setItem("lightview-theme",e)}catch(t){}}},N=async(e={})=>{const{shadowDefault:t=!0}=e;if(T.shadowDefault=t,t)try{const e=await fetch(S);if(!e.ok)throw new Error(`Failed to fetch DaisyUI CSS: ${e.status}`);const t=await e.text(),n=new CSSStyleSheet;n.replaceSync(t),T.daisyStyleSheet=n}catch(n){console.error("LightviewX: Failed to preload DaisyUI stylesheet:",n)}T.initialized=!0};(async()=>{await N()})();const k=(e,t=[])=>{const n=[];if(T.daisyStyleSheet?n.push(T.daisyStyleSheet):n.push(S),T.themeStyleSheet&&n.push(T.themeStyleSheet),e){const t=T.componentStyleSheets.get(e);t&&n.push(t)}return Array.isArray(t)&&t.forEach(e=>{const t=T.customStyleSheets.get(e);t?n.push(t):(C(e),n.push(e))}),n},M=e=>{try{const t=e.trim().startsWith("${")&&e.trim().endsWith("}")&&!e.trim().includes("${",2)?"return "+e.trim().slice(2,-1):"return `"+e.replace(/\\/g,"\\\\").replace(/`/g,"\\`")+"`";return new Function("state","signal",t)}catch(t){return()=>""}},_=(e,t,n=null)=>{const r="script"===n||"style"===n,o=globalThis.Lightview;return e.map(e=>e.nodeType===Node.TEXT_NODE?((e,t,n)=>{const r=e.textContent;if(t)return r;if(!r.trim()&&!r.includes("${"))return null;if(r.includes("${")){const e=M(r);return()=>e(n.state,n.signal)}return r})(e,r,o):e.nodeType===Node.ELEMENT_NODE?((e,t,n)=>{const r=e.tagName.toLowerCase(),o={},s="script"===r||"style"===r,i="undefined"!=typeof window||"undefined"!=typeof globalThis?globalThis.Lightview:null;for(let a of e.attributes){const e=a.value;o[a.name]=!s&&e.includes("${")?(()=>{const t=M(e);return()=>t(i.state,i.signal)})():e}return t(r,o,n(Array.from(e.childNodes),t,r))})(e,t,_):null).filter(e=>null!==e)},W=new WeakMap,D=(e,t=!1)=>document.createComment(`lv-src-${t?"end":"start"}:${e}`),$=e=>{if(!e)return;e.querySelectorAll("script").forEach(e=>{const t=document.createElement("script");Array.from(e.attributes).forEach(e=>{t.setAttribute(e.name,e.value)}),e.src?t.src=e.src:t.textContent=e.textContent,e.parentNode.replaceChild(t,e)})},x=(e,t,n,r,o,s=!1,i="")=>{var a;if(t)return Array.isArray(e)?e:[e];if(s&&"cdomc"===i){const t=null==(a=globalThis.LightviewCDOM)?void 0:a.parseCDOMC;if(!t)return console.warn("LightviewX: CDOMC parser not found. Ensure lightview-cdom.js is loaded."),[];try{const n=t(e);return Array.isArray(n)?n:[n]}catch(l){return console.warn("LightviewX: Failed to parse .cdomc:",l),[]}}if(n){if("true"===r.domEl.getAttribute("escape"))return[e];const t=(new DOMParser).parseFromString(e.replace(/<head[^>]*>[\s\S]*?<\/head>/i,""),"text/html");return _([...Array.from(t.head.childNodes),...Array.from(t.body.childNodes)],o)}return[e]},R=(e,t,n,r,o,{element:s,setupChildren:i},a=null)=>{const l=`${r}-${o.slice(0,8)}`;let c=d(W,e.domEl,()=>({}));c[r]&&((e,t)=>{const n=`lv-src-start:${t}`,r=`lv-src-end:${t}`;let o=!1;const s=[],i=document.createTreeWalker(e.parentElement||e,NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,null,!1);for(;i.nextNode();){const e=i.currentNode;if(e.nodeType===Node.COMMENT_NODE){if(e.textContent===n){o=!0,s.push(e);continue}if(e.textContent===r){s.push(e);break}}o&&s.push(e)}s.forEach(e=>e.remove()),s.length})(e.domEl,`${r}-${c[r].slice(0,8)}`),c[r]=o;const h=e=>{a&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{const t=a.startsWith("#")?a.slice(1):a,n=e.getElementById?e.getElementById(t):e.querySelector(`#${t}`);n&&(n.style.scrollMarginTop="calc(var(--site-nav-height, 0px) + 2rem)",n.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))})})};"shadow"===r?(e.domEl.shadowRoot||e.domEl.attachShadow({mode:"open"}),i(t,e.domEl.shadowRoot),$(e.domEl.shadowRoot),h(e.domEl.shadowRoot)):"innerhtml"===r?(e.children=t,$(e.domEl),h(document)):(((e,t,n,r,{element:o,setupChildren:s})=>{const i="outerhtml"===n,a="beforebegin"===n||"afterend"===n||i?t.parentElement:t;if(!a)return console.warn(`LightviewX: No parent for ${n}`);const l=document.createDocumentFragment();l.appendChild(D(r,!1)),e.forEach(e=>{var t,n,r;if("string"==typeof e)l.appendChild(document.createTextNode(e));else if(e.domEl)l.appendChild(e.domEl);else if(e instanceof Node)l.appendChild(e);else{const s=(null==(r=null==(t=globalThis.Lightview)?void 0:(n=t.hooks).processChild)?void 0:r.call(n,e))||e;if(s.tag){const e=o(s.tag,s.attributes||{},s.children||[]);(null==e?void 0:e.domEl)&&l.appendChild(e.domEl)}}}),l.appendChild(D(r,!0)),i?a.replaceChild(l,t):"beforebegin"===n?a.insertBefore(l,t):"afterend"===n?a.insertBefore(l,t.nextSibling):"afterbegin"===n?t.insertBefore(l,t.firstChild):"beforeend"===n&&t.appendChild(l),$(a)})(t,e.domEl,r,l,{element:s,setupChildren:i}),h(document))},I=async(e,t,n,{element:r,setupChildren:o})=>{if(y.includes(n))return;let s=[],i="",a=null;if("string"==typeof(l=t)&&!b(l)&&/^(https?:|\.|\/|[\w])|(\.(html|json|[vo]dom|cdomc?))$/i.test(l)){t.includes("#")&&([t,a]=t.split("#"));const n=await(async e=>{var t;try{const n=globalThis.Lightview;if((null==(t=null==n?void 0:n.hooks)?void 0:t.validateUrl)&&!n.hooks.validateUrl(e))return console.warn(`[LightviewX] Fetch blocked by validateUrl hook: ${e}`),null;const r=new URL(e,document.baseURI),o=await fetch(r);if(!o.ok)return null;const s=r.pathname.split(".").pop().toLowerCase(),i="vdom"===s||"odom"===s||"cdom"===s,a="html"===s,l="cdom"===s||"cdomc"===s,c=i?await o.json():await o.text();return{content:c,isJson:i,isHtml:a,isCdom:l,ext:s,raw:i?JSON.stringify(c):c}}catch(n){return null}})(t);n&&(s=x(n.content,n.isJson,n.isHtml,e,r,n.isCdom,n.ext),i=n.raw)}var l;if(!s.length){const e=((e,t)=>{try{const n=document.querySelectorAll(e);return n.length?{elements:_(Array.from(n),t),raw:Array.from(n).map(e=>e.outerHTML||e.textContent).join("")}:null}catch(n){return null}})(t,r);e&&(s=e.elements,i=e.raw)}if(!s.length)return;const c=(e.domEl.getAttribute("location")||"innerhtml").toLowerCase(),h=(e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t.toString(36)})(i);if(d(W,e.domEl,()=>({}))[c]!==h)R(e,s,0,c,h,{element:r,setupChildren:o},a);else if(a){const t="shadow"===c?e.domEl.shadowRoot:document;t&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{var e;const n=a.startsWith("#")?a.slice(1):a,r=t.getElementById?t.getElementById(n):null==(e=t.querySelector)?void 0:e.call(t,`#${n}`);r&&(r.style.scrollMarginTop="calc(var(--site-nav-height, 0px) + 2rem)",r.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))})})}},j=["beforebegin","afterbegin","beforeend","afterend","innerhtml","outerhtml","shadow"],F=(e,{domToElement:t,wrapDomElement:n})=>{var r;const o=e.target.closest("[href]");if(!o)return;const s=o.tagName.toLowerCase();if(v.includes(s))return;e.preventDefault();const i=o.getAttribute("href"),a=globalThis.Lightview;if(i&&(b(i)||(null==(r=null==a?void 0:a.hooks)?void 0:r.validateUrl)&&!a.hooks.validateUrl(i)))return void console.warn(`[LightviewX] Navigation or fetch blocked by security policy: ${i}`);const l=o.getAttribute("target");if(!l){let e=t.get(o);if(!e){const t={};for(let e of o.attributes)t[e.name]=e.value;e=n(o,s,t)}const r={...e.attributes,src:i};return void(e.attributes=r)}if(l.startsWith("_")){switch(l){case"_self":globalThis.location.href=i;break;case"_parent":globalThis.parent.location.href=i;break;case"_top":globalThis.top.location.href=i;break;default:globalThis.open(i,l)}return}const{selector:c,location:h}=(e=>{for(const t of j){const n=":"+t;if(e.toLowerCase().endsWith(n))return{selector:e.slice(0,-n.length),location:t}}return{selector:e,location:null}})(l);try{document.querySelectorAll(c).forEach(e=>{let r=t.get(e);if(!r){const t={};for(let n of e.attributes)t[n.name]=n.value;r=n(e,e.tagName.toLowerCase(),t)}const o={...r.attributes,src:i};h&&(o.location=h),r.attributes=o})}catch(u){console.warn("Invalid target selector:",c,u)}},P=new WeakMap,U="__lv_passed",X="__lv_resume",H=["click","dblclick","mousedown","mouseup","contextmenu","submit","reset","change","input","invalid","keydown","keyup","keypress","touchstart","touchend"],q=["focus","blur"],B=(e,t)=>{let n=P.get(e);n||(n=new Map,P.set(e,n));let r=n.get(t);return r||(r={},n.set(t,r)),r},J=function(e){const t=arguments[arguments.length-1];if(null==t?void 0:t[X])return!0;const n=`throttle-${(null==t?void 0:t.type)||"all"}-${e}`,r=B(this,n),o=Date.now();return o-(r.last||0)>=e&&(r.last=o,!0)},V=function(e){const t=arguments[arguments.length-1],n=`debounce-${(null==t?void 0:t.type)||"all"}-${e}`,r=B(this,n);return r.timer&&clearTimeout(r.timer),(null==t?void 0:t[X])&&r.passed?(r.passed=!1,!0):(r.timer=setTimeout(()=>{r.passed=!0;const e=new t.constructor(t.type,t);e[X]=!0,this.dispatchEvent(e)},e),!1)},z=async e=>{var t,n;if(e[U])return;const r=null==(n=(t=e.target).closest)?void 0:n.call(t,"[lv-before]");if(!r)return;const{events:o,exclusions:s,calls:i}=(e=>{const t=[];let n="",r=0,o=null;for(let c=0;c<e.length;c++){const s=e[c];o?(n+=s,s===o&&"\\"!==e[c-1]&&(o=null)):"'"===s||'"'===s?(o=s,n+=s):"("===s?(r++,n+=s):")"===s?(r--,n+=s):/\s/.test(s)&&0===r?(n&&t.push(n),n=""):n+=s}n&&t.push(n);const s=[],i=[],a=[];let l=0;for(;l<t.length;){const e=t[l];if(!e||e.includes("("))break;e.startsWith("!")?i.push(e.slice(1)):s.push(e),l++}for(;l<t.length;)t[l]&&a.push(t[l]),l++;return{events:s,exclusions:i,calls:a}})(r.getAttribute("lv-before")),a=s.includes(e.type),l=o.includes("*")||o.includes(e.type);if(a||!l)return;e.stopImmediatePropagation(),e.preventDefault();for(const u of i)try{const t=u.match(/^([\w\.]+)\((.*)\)$/);if(!t)continue;const n=t[1],o=t[2],s=globalThis.Lightview,i=globalThis.LightviewX;let a=n.split(".").reduce((e,t)=>null==e?void 0:e[t],globalThis);if(a||"throttle"!==n||(a=J),a||"debounce"!==n||(a=V),!a&&i&&i[n]&&(a=i[n]),"function"!=typeof a){console.warn(`LightviewX: lv-before function '${n}' not found`);continue}const l=new Function("event","state","signal",`return [${o}]`).call(r,e,(null==s?void 0:s.state)||{},(null==s?void 0:s.signal)||{});l.push(e);let c=a.apply(r,l);if(c instanceof Promise&&(c=await c),!1===c||null==c)return}catch(h){return void console.error(`LightviewX: Error executing lv-before gate '${u}':`,h)}const c=new e.constructor(e.type,e);c[U]=!0,r.dispatchEvent(c)},Y=(e,t)=>{if(e.nodeType!==Node.ELEMENT_NODE)return;const n=e.tagName.toLowerCase();if((e=>y.includes(e)||e.startsWith("lv-"))(n))return;const r=e.getAttribute("src");if(!r)return;let o=t.internals.domToElement.get(e);if(!o){const r={};for(let t of e.attributes)r[t.name]=t.value;o=t.internals.wrapDomElement(e,n,r,[])}I(o,r,n,{element:t.element,setupChildren:t.internals.setupChildren})},G=new WeakSet,K=(e,t)=>{if(!e||!t)return;const n=(e,n,r=!1,o=null)=>{if(G.has(e)&&!r)return;r||G.add(e);const s=M(n);t.effect(()=>{try{const n=s(t.state,t.signal);r?null==n||!1===n?e.removeAttribute(o):e.setAttribute(o,n):e.textContent=void 0!==n?n:""}catch(n){}})},r=document.evaluate(".//text()[contains(., '${')]",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let s=0;s<r.snapshotLength;s++){const e=r.snapshotItem(s);e.parentElement&&e.parentElement.closest("SCRIPT, STYLE, CODE, PRE, TEMPLATE, NOSCRIPT")||n(e,e.textContent)}const o=document.evaluate(".//*[@*[contains(., '${')]]",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let s=0;s<o.snapshotLength;s++){const e=o.snapshotItem(s);["SCRIPT","STYLE","CODE","PRE","TEMPLATE","NOSCRIPT"].includes(e.tagName)||Array.from(e.attributes).forEach(t=>{t.value.includes("${")&&n(e,t.value,!0,t.name)})}e.nodeType!==Node.ELEMENT_NODE||["SCRIPT","STYLE","CODE","PRE","TEMPLATE","NOSCRIPT"].includes(e.tagName)||Array.from(e.attributes).forEach(t=>{t.value.includes("${")&&n(e,t.value,!0,t.name)})},Q=(e,t,n)=>{if(e.nodeType!==Node.ELEMENT_NODE&&e.nodeType!==Node.TEXT_NODE||n.push(e),e.nodeType!==Node.ELEMENT_NODE)return;t.push(e);const r="[src]:not("+y.join("):not(")+")",o=e.querySelectorAll(r);for(const s of o)s.tagName.toLowerCase().startsWith("lv-")||t.push(s)},Z=e=>{const t=new MutationObserver(t=>{const{nodesToProcess:n,nodesToActivate:r}=(e=>{const t=[],n=[];for(const r of e)"childList"===r.type?r.addedNodes.forEach(e=>Q(e,t,n)):"attributes"===r.type&&"src"===r.attributeName&&t.push(r.target);return{nodesToProcess:t,nodesToActivate:n}})(t);(n.length>0||r.length>0)&&requestAnimationFrame(()=>{r.forEach(t=>K(t,e)),n.forEach(t=>Y(t,e))})});return t.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["src"]}),t};if("undefined"!=typeof window&&globalThis.Lightview){const e=globalThis.Lightview;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>Z(e)):Z(e);const t=()=>{requestAnimationFrame(()=>{K(document.body,e);const t="[src]:not("+y.join("):not(")+")";document.querySelectorAll(t).forEach(t=>{t.tagName.toLowerCase().startsWith("lv-")||Y(t,e)})})};document.body?t():document.addEventListener("DOMContentLoaded",t),e.hooks.onNonStandardHref=t=>{F(t,{domToElement:e.internals.domToElement,wrapDomElement:e.internals.wrapDomElement})},H.forEach(e=>window.addEventListener(e,z,!0)),q.forEach(e=>window.addEventListener(e,z,!0)),e.hooks.processChild=t=>{if(!t)return t;if("object"!=typeof t||Array.isArray(t)||t.tag||t.domEl||(t=E(t)),"string"==typeof t&&t.startsWith("$")&&isNaN(parseInt(t[1]))){const e=globalThis.LightviewCDOM;if(e)return e.parseExpression(t)}if("string"==typeof t&&(t.trim().startsWith("{")||t.trim().startsWith("[")))try{const e=new Function("return ("+t+")")();if("object"==typeof e&&null!==e)return Array.isArray(e)||e.tag||e.domEl?e:E(e)}catch(n){}return((e,t)=>{if("string"==typeof e&&e.includes("${")){const n=M(e);return()=>n(t.state,t.signal)}return e})(t,{state:g,signal:e.signal})}}const ee={state:g,themeSignal:O,setTheme:A,registerStyleSheet:C,registerThemeSheet:async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch theme CSS: ${t.status}`);const n=await t.text(),r=new CSSStyleSheet;r.replaceSync(n),T.themeStyleSheet=r}catch(t){console.error(`LightviewX: Failed to register theme stylesheet '${e}':`,t)}},throttle:J,debounce:V,initComponents:N,componentConfig:T,shouldUseShadow:e=>void 0!==e?e:T.shadowDefault,getAdoptedStyleSheets:k,preloadComponentCSS:async e=>{T.componentStyleSheets.has(e)||await(async e=>{if(T.componentStyleSheets.has(e))return T.componentStyleSheets.get(e);try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch component CSS: ${t.status}`);const n=await t.text(),r=new CSSStyleSheet;return r.replaceSync(n),T.componentStyleSheets.set(e,r),r}catch(t){return console.error(`LightviewX: Failed to create stylesheet for ${e}:`,t),null}})(e)},createCustomElement:(e,t={})=>class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}async connectedCallback(){const{cssUrl:n,styles:r}=t;this.themeWrapper=document.createElement("div"),this.themeWrapper.style.display="contents";const o=()=>{const e=document.documentElement.getAttribute("data-theme")||"light";this.themeWrapper.setAttribute("data-theme",e)};o(),this.themeObserver=new MutationObserver(o),this.themeObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),this.shadowRoot.appendChild(this.themeWrapper);const s=k(n,r);try{const e=s.filter(e=>e instanceof CSSStyleSheet);this.shadowRoot.adoptedStyleSheets=e}catch(i){}if(!T.daisyStyleSheet){const e=document.createElement("link");e.rel="stylesheet",e.href=S,this.shadowRoot.appendChild(e)}s.forEach(e=>{if("string"==typeof e){const t=document.createElement("link");t.rel="stylesheet",t.href=e,this.shadowRoot.appendChild(t)}}),this.render=()=>{const t={};for(const e of this.attributes){const n=e.name.replace(/-([a-z])/g,e=>e[1].toUpperCase());""===e.value?t[n]=!0:t[n]=e.value}t.useShadow=!1;const n=globalThis.Lightview.tags.slot(),r=e(t,n);globalThis.Lightview.internals.setupChildren([r],this.themeWrapper)},"undefined"!=typeof MutationObserver&&"undefined"!=typeof HTMLElement&&(this.attrObserver=new MutationObserver(e=>{this.render()}),this.attrObserver.observe(this,{attributes:!0})),this.render()}disconnectedCallback(){this.themeObserver&&this.themeObserver.disconnect(),this.attrObserver&&this.attrObserver.disconnect()}},customElementWrapper:(e,t={})=>{const{attributeMap:n={},childElements:r={}}=t;return class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/daisyui@5.5.14/daisyui.min.css",this.shadowRoot.appendChild(e);const t=document.createElement("div");t.setAttribute("data-theme",document.documentElement.getAttribute("data-theme")||"light"),t.style.display="contents",this.shadowRoot.appendChild(t),this.themeWrapper=t,this.themeObserver=new MutationObserver(()=>{const e=document.documentElement.getAttribute("data-theme")||"light";this.themeWrapper.setAttribute("data-theme",e)}),this.themeObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),this.render();const o=Object.keys(n);o.length>0&&(this.attrObserver=new MutationObserver(()=>this.render()),this.attrObserver.observe(this,{attributes:!0,attributeFilter:o})),Object.keys(r).length>0&&(this.childObserver=new MutationObserver(()=>this.render()),this.childObserver.observe(this,{childList:!0,subtree:!0,attributes:!0}))}disconnectedCallback(){this.themeObserver&&this.themeObserver.disconnect(),this.attrObserver&&this.attrObserver.disconnect(),this.childObserver&&this.childObserver.disconnect()}parseChildrenToVDOM(){return Array.from(this.children).map(e=>{const t=e.tagName.toLowerCase(),n=r[t];if(!n)return null;const{component:o,attributeMap:s={},innerHTML:i=!1}=n,a={};return Object.entries(s).forEach(([t,n])=>{const r=e.getAttribute(t);null!==r&&(n===Boolean?a[t]="true"===r||""===r:a[t]=n===Number?Number(r):r)}),e.onclick&&(a.onclick=e.onclick.bind(e)),{tag:o,attributes:a,children:i?[e.innerHTML]:[e.textContent]}}).filter(Boolean)}render(){var t,o;const s={useShadow:!1};Object.entries(n).forEach(([e,t])=>{const n=this.getAttribute(e);null!==n&&(t===Boolean?s[e]="true"===n||""===n:s[e]=t===Number?Number(n):n)});const i=this.parseChildrenToVDOM(),a=Object.keys(r).length>0?i:[{tag:globalThis.Lightview.tags.slot}],l=e(s,...a);(null==(o=null==(t=globalThis.Lightview)?void 0:t.internals)?void 0:o.setupChildren)&&this.themeWrapper&&(this.themeWrapper.innerHTML="",globalThis.Lightview.internals.setupChildren([l],this.themeWrapper))}static get observedAttributes(){return Object.keys(n)}attributeChangedCallback(){this.render()}}},internals:{handleSrcAttribute:I,parseElements:x}};if("undefined"!=typeof module&&module.exports&&(module.exports=ee),"undefined"!=typeof window&&(globalThis.LightviewX=ee),"undefined"!=typeof window){try{const e=L();e&&A(e)}catch(te){}"undefined"!=typeof window&&globalThis.Lightview&&(globalThis.Lightview.hooks.validateUrl||(globalThis.Lightview.hooks.validateUrl=w))}"undefined"!=typeof globalThis&&globalThis.Lightview&&(globalThis.Lightview.hooks.validateUrl||(globalThis.Lightview.hooks.validateUrl=w))}();
