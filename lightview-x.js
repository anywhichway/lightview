!function(){"use strict";const e=globalThis.__LIGHTVIEW_INTERNALS__||(globalThis.__LIGHTVIEW_INTERNALS__={currentEffect:null,registry:new Map,dependencyMap:new WeakMap}),t=(t,n)=>{let o="string"==typeof n?n:null==n?void 0:n.name;const r=null==n?void 0:n.storage;if(o&&r)try{const e=r.getItem(o);null!==e&&(t=JSON.parse(e))}catch(l){}let s=t;const i=new Set,a=(...e)=>{if(0===e.length)return a.value;a.value=e[0]};if(Object.defineProperty(a,"value",{get:()=>(e.currentEffect&&(i.add(e.currentEffect),e.currentEffect.dependencies.add(i)),s),set(e){if(s!==e){if(s=e,o&&r)try{r.setItem(o,JSON.stringify(s))}catch(l){}[...i].forEach(e=>e())}}}),o)if(e.registry.has(o)){if(e.registry.get(o)!==a)throw new Error(`Lightview: A signal or state with the name "${o}" is already registered.`)}else e.registry.set(o,a);return a};t.get=(n,o)=>e.registry.has(n)||void 0===o?e.registry.get(n):t(o,n);const n=()=>e.registry,o=new WeakMap,r=new WeakMap,s=new WeakMap,i=(e,t)=>Object.getOwnPropertyNames(e).filter(n=>"function"==typeof e[n]&&t(n)),a=i(Date.prototype,e=>/^(to|get|valueOf)/.test(e)),l=i(Date.prototype,e=>/^set/.test(e)),c=["map","forEach","filter","find","findIndex","some","every","reduce","reduceRight","includes","indexOf","lastIndexOf","join","slice","concat","flat","flatMap","at","entries","keys","values"],u=["push","pop","shift","unshift","splice","sort","reverse","fill","copyWithin"],d=["map","forEach","filter","find","findIndex","some","every","flatMap"],h=(e,t,n)=>{let o=e.get(t);return o||(o=n(),e.set(t,o)),o},f=(e,n,o,r)=>{if("__parent__"===n)return s.get(o);r.has(n)||r.set(n,t(Reflect.get(e,n,o)));const i=r.get(n).value;if("object"==typeof i&&null!==i){const e=g(i);return s.set(e,o),e}return i},m=(e,n,o,r,s)=>{s.has(n)||s.set(n,t(Reflect.get(e,n,r)));const i=Reflect.set(e,n,o,r),a=s.get(n);return i&&a&&(a.value=o),i},p=(e,n,o=[])=>{const i=h(r,e,()=>new Map);if(!i.has(n)){const o="function"==typeof e[n]?e[n].call(e):e[n];i.set(n,t(o))}const p=e instanceof Date,y=Array.isArray(e),v=p?a:y?c:o,w=p?l:y?u:[];return new Proxy(e,{get(e,t,o){if("__parent__"===t)return s.get(o);const r=e[t];if("function"==typeof r){const a=v.includes(t),l=w.includes(t);return function(...c){if(a){const e=i.get(n);e&&e.value}const u="function"==typeof e[n]?e[n].call(e):e[n];if(y&&d.includes(t)&&"function"==typeof c[0]){const e=c[0];c[0]=function(t,n,r){const i="object"==typeof t&&null!==t?g(t):t;return i&&"object"==typeof i&&s.set(i,o),e.call(this,i,n,r)}}const h=r.apply(e,c),f="function"==typeof e[n]?e[n].call(e):e[n];if(u!==f||l){const e=i.get(n);e&&e.value!==f&&(e.value=f)}return h}}if(t===n){const r=i.get(n);return r?r.value:Reflect.get(e,t,o)}if(y&&!isNaN(parseInt(t))){const e=i.get(n);e&&e.value}return f(e,t,o,i)},set(e,t,o,r){if(t===n){const s=Reflect.set(e,t,o,r);if(s){const e=i.get(n);e&&(e.value=o)}return s}return m(e,t,o,r,i)}})},g=(t,i)=>{if("object"!=typeof t||null===t)return t;const a="string"==typeof i?i:null==i?void 0:i.name,l=null==i?void 0:i.storage;if(a&&l)try{const e=l.getItem(a);if(e){const n=JSON.parse(e);Array.isArray(t)&&Array.isArray(n)?(t.length=0,t.push(...n)):Object.assign(t,n)}}catch(u){}let c=o.get(t);if(!c){const e=Array.isArray(t),n=t instanceof Date,i=e||n;if(!i&&(t instanceof RegExp||t instanceof Map||t instanceof Set||t instanceof WeakMap||t instanceof WeakSet))return t;c=i?p(t,e?"length":n?"getTime":null):new Proxy(t,{get:(e,t,n)=>"__parent__"===t?s.get(n):f(e,t,n,h(r,e,()=>new Map)),set:(e,t,n,o)=>m(e,t,n,o,h(r,e,()=>new Map))}),o.set(t,c)}if(a&&l&&(t=>{const n=()=>{if(n.active&&!n.running){n.dependencies.forEach(e=>e.delete(n)),n.dependencies.clear(),n.running=!0,e.currentEffect=n;try{t()}finally{e.currentEffect=null,n.running=!1}}};n.active=!0,n.running=!1,n.dependencies=new Set,n.stop=()=>{n.dependencies.forEach(e=>e.delete(n)),n.dependencies.clear(),n.active=!1},n()})(()=>{try{l.setItem(a,JSON.stringify(c))}catch(u){}}),a){const e=n();if(e.has(a)){if(e.get(a)!==c)throw new Error(`Lightview: A signal or state with the name "${a}" is already registered.`)}else e.set(a,c)}return c};g.get=(e,t)=>{const o=n();return o.has(e)||void 0===t?o.get(e):g(t,e)};const y=["img","script","iframe","video","audio","source","track","embed","input"],v=["a","area","base","link"],w=e=>{if(!e||"string"!=typeof e)return!1;const t=e.trim().toLowerCase();return t.startsWith("javascript:")||t.startsWith("vbscript:")||t.startsWith("data:text/html")||t.startsWith("data:application/javascript")},E=e=>{if(!e)return!1;if(!/^[a-z][a-z0-9+.-]*:/i.test(e))return!0;try{const t="undefined"!=typeof document?document.baseURI:globalThis.location.origin,n=new URL(e,"null"===t?void 0:t),o=globalThis.location;return n.origin===o.origin&&"null"!==n.origin||(!(!n.hostname||n.hostname!==o.hostname)||(!!(n.hostname&&o.hostname&&n.hostname.endsWith("."+o.hostname))||"file:"===o.protocol&&"file:"===n.protocol))}catch(t){return!1}},b=e=>{var t,n;if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return e.map(b);if(e.tag)return{...e,children:e.children?b(e.children):[]};if(e.domEl||!(e=>{if("object"!=typeof e||null===e||Array.isArray(e)||e.tag||e.domEl)return!1;const t=Object.keys(e);return 1===t.length&&"string"==typeof(n=t[0])&&n.length>0&&"children"!==n&&"object"==typeof e[t[0]];var n})(e))return e;const o=Object.keys(e)[0],r=e[o],s="undefined"!=typeof window||"undefined"!=typeof globalThis?globalThis.Lightview:null,i=(null==(n=null==(t=null==s?void 0:s.tags)?void 0:t._customTags)?void 0:n[o])||o,{children:a,...l}=r;return{tag:i,attributes:l,children:a?b(a):[]}},S="https://cdn.jsdelivr.net/npm/daisyui@3.9.4/dist/full.min.css",T={initialized:!1,shadowDefault:!0,daisyStyleSheet:null,themeStyleSheet:null,componentStyleSheets:new Map,customStyleSheets:new Map},C=async(e,t)=>{if(!T.customStyleSheets.has(e))try{let n=t;if(void 0===n)if(e.startsWith("#")){const t=document.querySelector(e);if(!t)throw new Error(`Style block '${e}' not found`);n=t.textContent}else{const t=await fetch(e);if(!t.ok)throw new Error(`Fetch failed: ${t.status}`);n=await t.text()}if(void 0!==n){const t=new CSSStyleSheet;t.replaceSync(n),T.customStyleSheets.set(e,t)}}catch(n){console.error(`LightviewX: Failed to register stylesheet '${e}':`,n)}},L=()=>{try{if("undefined"!=typeof localStorage)return localStorage.getItem("lightview-theme")}catch(e){return null}},N=t("undefined"!=typeof document&&document.documentElement.getAttribute("data-theme")||L()||"light"),A=e=>{if(e){"undefined"!=typeof document&&document.documentElement.setAttribute("data-theme",e),N&&N.value!==e&&(N.value=e);try{"undefined"!=typeof localStorage&&localStorage.setItem("lightview-theme",e)}catch(t){}}},O=async(e={})=>{const{shadowDefault:t=!0}=e;if(T.shadowDefault=t,t)try{const e=await fetch(S);if(!e.ok)throw new Error(`Failed to fetch DaisyUI CSS: ${e.status}`);const t=await e.text(),n=new CSSStyleSheet;n.replaceSync(t),T.daisyStyleSheet=n}catch(n){console.error("LightviewX: Failed to preload DaisyUI stylesheet:",n)}T.initialized=!0};(async()=>{await O()})();const k=(e,t=[])=>{const n=[];if(T.daisyStyleSheet?n.push(T.daisyStyleSheet):n.push(S),T.themeStyleSheet&&n.push(T.themeStyleSheet),e){const t=T.componentStyleSheets.get(e);t&&n.push(t)}return Array.isArray(t)&&t.forEach(e=>{const t=T.customStyleSheets.get(e);t?n.push(t):(C(e),n.push(e))}),n},_=e=>{try{const t=e.trim().startsWith("${")&&e.trim().endsWith("}")&&!e.trim().includes("${",2)?"return "+e.trim().slice(2,-1):"return `"+e.replace(/\\/g,"\\\\").replace(/`/g,"\\`")+"`";return new Function("state","signal",t)}catch(t){return()=>""}},M=(e,t,n=null)=>{const o="script"===n||"style"===n,r=globalThis.Lightview;return e.map(e=>e.nodeType===Node.TEXT_NODE?((e,t,n)=>{const o=e.textContent;if(t)return o;if(!o.trim()&&!o.includes("${"))return null;if(o.includes("${")){const e=_(o);return()=>e(n.state,n.signal)}return o})(e,o,r):e.nodeType===Node.ELEMENT_NODE?((e,t,n)=>{const o=e.tagName.toLowerCase(),r={},s="script"===o||"style"===o,i="undefined"!=typeof window||"undefined"!=typeof globalThis?globalThis.Lightview:null;for(let a of e.attributes){const e=a.value;r[a.name]=!s&&e.includes("${")?(()=>{const t=_(e);return()=>t(i.state,i.signal)})():e}return t(o,r,n(Array.from(e.childNodes),t,o))})(e,t,M):null).filter(e=>null!==e)},$=new WeakMap,D=(e,t=!1)=>document.createComment(`lv-src-${t?"end":"start"}:${e}`),W=e=>{if(!e)return;e.querySelectorAll("script").forEach(e=>{const t=document.createElement("script");Array.from(e.attributes).forEach(e=>{t.setAttribute(e.name,e.value)}),e.src?t.src=e.src:t.textContent=e.textContent,e.parentNode.replaceChild(t,e)})},x=(e,t,n,o,r,s=!1,i="")=>{var a;if(t)return Array.isArray(e)?e:[e];if(s&&"cdomc"===i){const t=null==(a=globalThis.LightviewCDOM)?void 0:a.parseCDOMC;if(!t)return console.warn("LightviewX: CDOMC parser not found. Ensure lightview-cdom.js is loaded."),[];try{const n=t(e);return Array.isArray(n)?n:[n]}catch(l){return console.warn("LightviewX: Failed to parse .cdomc:",l),[]}}if(n){if("true"===o.domEl.getAttribute("escape"))return[e];const t=(new DOMParser).parseFromString(e.replace(/<head[^>]*>[\s\S]*?<\/head>/i,""),"text/html");return M([...Array.from(t.head.childNodes),...Array.from(t.body.childNodes)],r)}return[e]},I=(e,t,n,o,r,{element:s,setupChildren:i},a=null)=>{const l=`${o}-${r.slice(0,8)}`;let c=h($,e.domEl,()=>({}));c[o]&&((e,t)=>{const n=`lv-src-start:${t}`,o=`lv-src-end:${t}`;let r=!1;const s=[],i=document.createTreeWalker(e.parentElement||e,NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,null,!1);for(;i.nextNode();){const e=i.currentNode;if(e.nodeType===Node.COMMENT_NODE){if(e.textContent===n){r=!0,s.push(e);continue}if(e.textContent===o){s.push(e);break}}r&&s.push(e)}s.forEach(e=>e.remove()),s.length})(e.domEl,`${o}-${c[o].slice(0,8)}`),c[o]=r;const u=e=>{a&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{const t=a.startsWith("#")?a.slice(1):a,n=e.getElementById?e.getElementById(t):e.querySelector(`#${t}`);n&&(n.style.scrollMarginTop="calc(var(--site-nav-height, 0px) + 2rem)",n.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))})})};"shadow"===o?(e.domEl.shadowRoot||e.domEl.attachShadow({mode:"open"}),i(t,e.domEl.shadowRoot),W(e.domEl.shadowRoot),u(e.domEl.shadowRoot)):"innerhtml"===o?(e.children=t,W(e.domEl),u(document)):(((e,t,n,o,{element:r,setupChildren:s})=>{const i="outerhtml"===n,a="beforebegin"===n||"afterend"===n||i?t.parentElement:t;if(!a)return console.warn(`LightviewX: No parent for ${n}`);const l=document.createDocumentFragment();l.appendChild(D(o,!1)),e.forEach(e=>{var t,n,o;if("string"==typeof e)l.appendChild(document.createTextNode(e));else if(e.domEl)l.appendChild(e.domEl);else if(e instanceof Node)l.appendChild(e);else{const s=(null==(o=null==(t=globalThis.Lightview)?void 0:(n=t.hooks).processChild)?void 0:o.call(n,e))||e;if(s.tag){const e=r(s.tag,s.attributes||{},s.children||[]);(null==e?void 0:e.domEl)&&l.appendChild(e.domEl)}}}),l.appendChild(D(o,!0)),i?a.replaceChild(l,t):"beforebegin"===n?a.insertBefore(l,t):"afterend"===n?a.insertBefore(l,t.nextSibling):"afterbegin"===n?t.insertBefore(l,t.firstChild):"beforeend"===n&&t.appendChild(l),W(a)})(t,e.domEl,o,l,{element:s,setupChildren:i}),u(document))},R=async(e,t,n,{element:o,setupChildren:r})=>{if(y.includes(n))return;let s=[],i="",a=null;if("string"==typeof(l=t)&&!w(l)&&/^(https?:|\.|\/|[\w])|(\.(html|json|[vo]dom|cdomc?))$/i.test(l)){t.includes("#")&&([t,a]=t.split("#"));const n=await(async e=>{var t;try{const n=globalThis.Lightview;if((null==(t=null==n?void 0:n.hooks)?void 0:t.validateUrl)&&!n.hooks.validateUrl(e))return console.warn(`[LightviewX] Fetch blocked by validateUrl hook: ${e}`),null;const o=new URL(e,document.baseURI),r=await fetch(o);if(!r.ok)return null;const s=o.pathname.split(".").pop().toLowerCase(),i="vdom"===s||"odom"===s||"cdom"===s,a="html"===s,l="cdom"===s||"cdomc"===s,c=i?await r.json():await r.text();return{content:c,isJson:i,isHtml:a,isCdom:l,ext:s,raw:i?JSON.stringify(c):c}}catch(n){return null}})(t);n&&(s=x(n.content,n.isJson,n.isHtml,e,o,n.isCdom,n.ext),i=n.raw)}var l;if(!s.length){const e=((e,t)=>{try{const n=document.querySelectorAll(e);return n.length?{elements:M(Array.from(n),t),raw:Array.from(n).map(e=>e.outerHTML||e.textContent).join("")}:null}catch(n){return null}})(t,o);e&&(s=e.elements,i=e.raw)}if(!s.length)return;const c=(e.domEl.getAttribute("location")||"innerhtml").toLowerCase(),u=(e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t.toString(36)})(i);if(h($,e.domEl,()=>({}))[c]!==u)I(e,s,0,c,u,{element:o,setupChildren:r},a);else if(a){const t="shadow"===c?e.domEl.shadowRoot:document;t&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{var e;const n=a.startsWith("#")?a.slice(1):a,o=t.getElementById?t.getElementById(n):null==(e=t.querySelector)?void 0:e.call(t,`#${n}`);o&&(o.style.scrollMarginTop="calc(var(--site-nav-height, 0px) + 2rem)",o.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))})})}},P=["beforebegin","afterbegin","beforeend","afterend","innerhtml","outerhtml","shadow"],F=(e,{domToElement:t,wrapDomElement:n})=>{var o;const r=e.target.closest("[href]");if(!r)return;const s=r.tagName.toLowerCase();if(v.includes(s))return;e.preventDefault();const i=r.getAttribute("href"),a=globalThis.Lightview;if(i&&(w(i)||(null==(o=null==a?void 0:a.hooks)?void 0:o.validateUrl)&&!a.hooks.validateUrl(i)))return void console.warn(`[LightviewX] Navigation or fetch blocked by security policy: ${i}`);const l=r.getAttribute("target");if(!l){let e=t.get(r);if(!e){const t={};for(let e of r.attributes)t[e.name]=e.value;e=n(r,s,t)}const o={...e.attributes,src:i};return void(e.attributes=o)}if(l.startsWith("_")){switch(l){case"_self":globalThis.location.href=i;break;case"_parent":globalThis.parent.location.href=i;break;case"_top":globalThis.top.location.href=i;break;default:globalThis.open(i,l)}return}const{selector:c,location:u}=(e=>{for(const t of P){const n=":"+t;if(e.toLowerCase().endsWith(n))return{selector:e.slice(0,-n.length),location:t}}return{selector:e,location:null}})(l);try{document.querySelectorAll(c).forEach(e=>{let o=t.get(e);if(!o){const t={};for(let n of e.attributes)t[n.name]=n.value;o=n(e,e.tagName.toLowerCase(),t)}const r={...o.attributes,src:i};u&&(r.location=u),o.attributes=r})}catch(d){console.warn("Invalid target selector:",c,d)}},j=new WeakMap,U="__lv_passed",X="__lv_resume",q=["click","dblclick","mousedown","mouseup","contextmenu","submit","reset","change","input","invalid","keydown","keyup","keypress","touchstart","touchend"],H=["focus","blur"],B=(e,t)=>{let n=j.get(e);n||(n=new Map,j.set(e,n));let o=n.get(t);return o||(o={},n.set(t,o)),o},J=function(e){const t=arguments[arguments.length-1];if(null==t?void 0:t[X])return!0;const n=`throttle-${(null==t?void 0:t.type)||"all"}-${e}`,o=B(this,n),r=Date.now();return r-(o.last||0)>=e&&(o.last=r,!0)},z=function(e){const t=arguments[arguments.length-1],n=`debounce-${(null==t?void 0:t.type)||"all"}-${e}`,o=B(this,n);return o.timer&&clearTimeout(o.timer),(null==t?void 0:t[X])&&o.passed?(o.passed=!1,!0):(o.timer=setTimeout(()=>{o.passed=!0;const e=new t.constructor(t.type,t);e[X]=!0,this.dispatchEvent(e)},e),!1)},Y=async e=>{var t,n;if(e[U])return;const o=null==(n=(t=e.target).closest)?void 0:n.call(t,"[lv-before]");if(!o)return;const{events:r,exclusions:s,calls:i}=(e=>{const t=[];let n="",o=0,r=null;for(let c=0;c<e.length;c++){const s=e[c];r?(n+=s,s===r&&"\\"!==e[c-1]&&(r=null)):"'"===s||'"'===s?(r=s,n+=s):"("===s?(o++,n+=s):")"===s?(o--,n+=s):/\s/.test(s)&&0===o?(n&&t.push(n),n=""):n+=s}n&&t.push(n);const s=[],i=[],a=[];let l=0;for(;l<t.length;){const e=t[l];if(!e||e.includes("("))break;e.startsWith("!")?i.push(e.slice(1)):s.push(e),l++}for(;l<t.length;)t[l]&&a.push(t[l]),l++;return{events:s,exclusions:i,calls:a}})(o.getAttribute("lv-before")),a=s.includes(e.type),l=r.includes("*")||r.includes(e.type);if(a||!l)return;e.stopImmediatePropagation(),e.preventDefault();for(const d of i)try{const t=d.match(/^([\w\.]+)\((.*)\)$/);if(!t)continue;const n=t[1],r=t[2],s=globalThis.Lightview,i=globalThis.LightviewX;let a=n.split(".").reduce((e,t)=>null==e?void 0:e[t],globalThis);if(a||"throttle"!==n||(a=J),a||"debounce"!==n||(a=z),!a&&i&&i[n]&&(a=i[n]),"function"!=typeof a){console.warn(`LightviewX: lv-before function '${n}' not found`);continue}const l=new Function("event","state","signal",`return [${r}]`).call(o,e,(null==s?void 0:s.state)||{},(null==s?void 0:s.signal)||{});l.push(e);let c=a.apply(o,l);if(c instanceof Promise&&(c=await c),!1===c||null==c)return}catch(u){return void console.error(`LightviewX: Error executing lv-before gate '${d}':`,u)}const c=new e.constructor(e.type,e);c[U]=!0,o.dispatchEvent(c)},V=(e,t)=>{if(e.nodeType!==Node.ELEMENT_NODE)return;const n=e.tagName.toLowerCase();if((e=>y.includes(e)||e.startsWith("lv-"))(n))return;const o=e.getAttribute("src");if(!o)return;let r=t.internals.domToElement.get(e);if(!r){const o={};for(let t of e.attributes)o[t.name]=t.value;r=t.internals.wrapDomElement(e,n,o,[])}R(r,o,n,{element:t.element,setupChildren:t.internals.setupChildren})},G=new WeakSet,K=(e,t)=>{if(!e||!t)return;const n=(e,n,o=!1,r=null)=>{if(G.has(e)&&!o)return;o||G.add(e);const s=_(n);t.effect(()=>{try{const n=s(t.state,t.signal);o?null==n||!1===n?e.removeAttribute(r):e.setAttribute(r,n):e.textContent=void 0!==n?n:""}catch(n){}})},o=document.evaluate(".//text()[contains(., '${')]",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let s=0;s<o.snapshotLength;s++){const e=o.snapshotItem(s);e.parentElement&&e.parentElement.closest("SCRIPT, STYLE, CODE, PRE, TEMPLATE, NOSCRIPT")||n(e,e.textContent)}const r=document.evaluate(".//*[@*[contains(., '${')]]",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let s=0;s<r.snapshotLength;s++){const e=r.snapshotItem(s);["SCRIPT","STYLE","CODE","PRE","TEMPLATE","NOSCRIPT"].includes(e.tagName)||Array.from(e.attributes).forEach(t=>{t.value.includes("${")&&n(e,t.value,!0,t.name)})}e.nodeType!==Node.ELEMENT_NODE||["SCRIPT","STYLE","CODE","PRE","TEMPLATE","NOSCRIPT"].includes(e.tagName)||Array.from(e.attributes).forEach(t=>{t.value.includes("${")&&n(e,t.value,!0,t.name)})},Q=(e,t,n)=>{if(e.nodeType!==Node.ELEMENT_NODE&&e.nodeType!==Node.TEXT_NODE||n.push(e),e.nodeType!==Node.ELEMENT_NODE)return;t.push(e);const o="[src]:not("+y.join("):not(")+")",r=e.querySelectorAll(o);for(const s of r)s.tagName.toLowerCase().startsWith("lv-")||t.push(s)},Z=e=>{const t=new MutationObserver(t=>{const{nodesToProcess:n,nodesToActivate:o}=(e=>{const t=[],n=[];for(const o of e)"childList"===o.type?o.addedNodes.forEach(e=>Q(e,t,n)):"attributes"===o.type&&"src"===o.attributeName&&t.push(o.target);return{nodesToProcess:t,nodesToActivate:n}})(t);(n.length>0||o.length>0)&&requestAnimationFrame(()=>{o.forEach(t=>K(t,e)),n.forEach(t=>V(t,e))})});return t.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["src"]}),t};if("undefined"!=typeof window&&globalThis.Lightview){const e=globalThis.Lightview;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>Z(e)):Z(e);const t=()=>{requestAnimationFrame(()=>{K(document.body,e);const t="[src]:not("+y.join("):not(")+")";document.querySelectorAll(t).forEach(t=>{t.tagName.toLowerCase().startsWith("lv-")||V(t,e)})})};document.body?t():document.addEventListener("DOMContentLoaded",t),e.hooks.onNonStandardHref=t=>{F(t,{domToElement:e.internals.domToElement,wrapDomElement:e.internals.wrapDomElement})},q.forEach(e=>window.addEventListener(e,Y,!0)),H.forEach(e=>window.addEventListener(e,Y,!0)),e.hooks.processChild=t=>{if(!t)return t;if("object"!=typeof t||Array.isArray(t)||t.tag||t.domEl||(t=b(t)),"string"==typeof t&&t.startsWith("$")&&isNaN(parseInt(t[1]))){const e=globalThis.LightviewCDOM;if(e)return e.parseExpression(t)}if("string"==typeof t&&(t.trim().startsWith("{")||t.trim().startsWith("[")))try{const e=new Function("return ("+t+")")();if("object"==typeof e&&null!==e)return Array.isArray(e)||e.tag||e.domEl?e:b(e)}catch(n){}return((e,t)=>{if("string"==typeof e&&e.includes("${")){const n=_(e);return()=>n(t.state,t.signal)}return e})(t,{state:g,signal:e.signal})}}const ee={state:g,themeSignal:N,setTheme:A,registerStyleSheet:C,registerThemeSheet:async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch theme CSS: ${t.status}`);const n=await t.text(),o=new CSSStyleSheet;o.replaceSync(n),T.themeStyleSheet=o}catch(t){console.error(`LightviewX: Failed to register theme stylesheet '${e}':`,t)}},throttle:J,debounce:z,initComponents:O,componentConfig:T,shouldUseShadow:e=>void 0!==e?e:T.shadowDefault,getAdoptedStyleSheets:k,preloadComponentCSS:async e=>{T.componentStyleSheets.has(e)||await(async e=>{if(T.componentStyleSheets.has(e))return T.componentStyleSheets.get(e);try{const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch component CSS: ${t.status}`);const n=await t.text(),o=new CSSStyleSheet;return o.replaceSync(n),T.componentStyleSheets.set(e,o),o}catch(t){return console.error(`LightviewX: Failed to create stylesheet for ${e}:`,t),null}})(e)},createCustomElement:(e,t={})=>class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}async connectedCallback(){const{cssUrl:n,styles:o}=t;this.themeWrapper=document.createElement("div"),this.themeWrapper.style.display="contents";const r=()=>{const e=document.documentElement.getAttribute("data-theme")||"light";this.themeWrapper.setAttribute("data-theme",e)};r(),this.themeObserver=new MutationObserver(r),this.themeObserver.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),this.shadowRoot.appendChild(this.themeWrapper);const s=k(n,o);try{const e=s.filter(e=>e instanceof CSSStyleSheet);this.shadowRoot.adoptedStyleSheets=e}catch(i){}if(!T.daisyStyleSheet){const e=document.createElement("link");e.rel="stylesheet",e.href=S,this.shadowRoot.appendChild(e)}s.forEach(e=>{if("string"==typeof e){const t=document.createElement("link");t.rel="stylesheet",t.href=e,this.shadowRoot.appendChild(t)}}),this.render=()=>{const t={};for(const e of this.attributes){const n=e.name.replace(/-([a-z])/g,e=>e[1].toUpperCase());""===e.value?t[n]=!0:t[n]=e.value}t.useShadow=!1;const n=globalThis.Lightview.tags.slot(),o=e(t,n);globalThis.Lightview.internals.setupChildren([o],this.themeWrapper)},"undefined"!=typeof MutationObserver&&"undefined"!=typeof HTMLElement&&(this.attrObserver=new MutationObserver(e=>{this.render()}),this.attrObserver.observe(this,{attributes:!0})),this.render()}disconnectedCallback(){this.themeObserver&&this.themeObserver.disconnect(),this.attrObserver&&this.attrObserver.disconnect()}},internals:{handleSrcAttribute:R,parseElements:x}};if("undefined"!=typeof module&&module.exports&&(module.exports=ee),"undefined"!=typeof window&&(globalThis.LightviewX=ee),"undefined"!=typeof window){try{const e=L();e&&A(e)}catch(te){}"undefined"!=typeof window&&globalThis.Lightview&&(globalThis.Lightview.hooks.validateUrl||(globalThis.Lightview.hooks.validateUrl=E))}"undefined"!=typeof globalThis&&globalThis.Lightview&&(globalThis.Lightview.hooks.validateUrl||(globalThis.Lightview.hooks.validateUrl=E))}();
